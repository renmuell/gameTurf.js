!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.gameTurf=e()}}(function(){return function i(r,a,s){function l(n,e){if(!a[n]){if(!r[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(d)return d(n,!0);throw new Error("Cannot find module '"+n+"'")}var o=a[n]={exports:{}};r[n][0].call(o.exports,function(e){var t=r[n][1][e];return l(t||e)},o,o.exports,i,r,a,s)}return a[n].exports}for(var d="function"==typeof require&&require,e=0;e<s.length;e++)l(s[e]);return l}({1:[function(f,p,e){!function(){var e=f("./settings"),t=f("./input"),n=f("./theatre"),o=f("./../systems/world"),i=f("./ui"),r=f("./../detectors/entityCollisionDetection"),a=f("./../managers/entityManager"),s=f("./../detectors/worldCollsitionDetection"),l=f("./../systems/wind"),d=f("./sound"),c=f("../../vendors/stats.min"),u={isRunning:!1,showStats:!1,init:function(){u.showStats&&u.statsSetup(),n.init(e.theatreMovesWithPlayer),i.init(function(){u.run()}),t.init(n.stageCanvas),e.theatreMovesWithPlayer||o.draw(),window.onblur=function(){u.pause()},t.onEscDown(function(){u.isRunning?u.pause():u.run()})},run:function(){u.isRunning=!0,i.closeMenu(),d.playBackgroundSound(),requestAnimationFrame(u.loop)},pause:function(){i.openMenu(),d.pauseBackgroundSound(),u.isRunning=!1},loop:function(){u.isRunning&&(u.showStats&&u.stats.begin(),u.update(),u.postUpdate(),u.preDraw(),u.draw(),u.showStats&&u.stats.end(),requestAnimationFrame(u.loop))},update:function(){l.update(),s.update(),a.update(),r.update()},postUpdate:function(){a.postUpdate()},preDraw:function(){a.preDraw(),n.clearStage(),n.preShake()},draw:function(){a.draw(),e.theatreMovesWithPlayer&&o.draw(),n.worldNeedsRedraw&&(n.clearWorld(),o.draw(),n.worldNeedsRedraw=!1),s.draw(),l.draw(),n.postShake()},statsSetup:function(){u.stats=new c,u.stats.setMode(2),u.stats.domElement.style.position="absolute",u.stats.domElement.style.left="0px",u.stats.domElement.style.top="0px",document.body.appendChild(u.stats.domElement)}};if(i.datGui){var h=i.datGui.addFolder("Game");i.datGui.remember(u),h.add(u,"drawWorld")}p.exports=u}()},{"../../vendors/stats.min":23,"./../detectors/entityCollisionDetection":9,"./../detectors/worldCollsitionDetection":10,"./../managers/entityManager":16,"./../systems/wind":18,"./../systems/world":19,"./input":2,"./settings":4,"./sound":5,"./theatre":6,"./ui":7}],2:[function(e,t,n){var o,i;o=e("./theatre"),i={keyPressed:[],onEscDownCallbacks:[],onEscUpCallbacks:[],shiftPressed:!1,movementDirectionData:{playerInteraction:!1,isRunning:!1,vector:{x:0,y:0}},lastClickPosition:{new:!1},recordMouseMove:!1,onEscDown:function(e){i.onEscDownCallbacks.push(e)},onEscUp:function(e){i.onEscUpCallbacks.push(e)},init:function(e){document.addEventListener("keydown",i.keydown),document.addEventListener("keyup",i.keyup),e.addEventListener("mousedown",i.stageCanvasMousedownHandler,!1),e.addEventListener("mousemove",i.stageCanvasMousemoveHandler,!1),e.addEventListener("mouseup",i.stageCanvasMouseupHandler,!1)},keydown:function(e){if(i.keyPressed[e.keyCode]=!0,i.shiftPressed=e.shiftKey,27==e.keyCode)for(var t=i.onEscDownCallbacks.length-1;0<=t;t--)i.onEscDownCallbacks[t].call()},keyup:function(e){if(i.keyPressed[e.keyCode]=!1,i.shiftPressed=e.shiftKey,27==e.keyCode)for(var t=i.onEscUpCallbacks.length-1;0<=t;t--)i.onEscUpCallbacks[t].call()},stageCanvasMousedownHandler:function(e){i.lastClickPosition.x=e.offsetX,i.lastClickPosition.y=e.offsetY,i.lastClickPosition.new=!0,o.adjustPositionToStage(i.lastClickPosition),i.recordMouseMove=!0},stageCanvasMousemoveHandler:function(e){i.recordMouseMove&&(i.lastClickPosition.x=e.offsetX,i.lastClickPosition.y=e.offsetY,i.lastClickPosition.new=!0,o.adjustPositionToStage(i.lastClickPosition))},stageCanvasMouseupHandler:function(e){i.recordMouseMove=!1},getPlayerMovementDirection:function(){return i.movementDirectionData.vector.x=0,i.movementDirectionData.vector.y=0,i.movementDirectionData.playerInteraction=!1,i.movementDirectionData.isRunning=i.shiftPressed,(i.keyPressed[37]||i.keyPressed[65])&&(i.movementDirectionData.vector.x-=1,i.movementDirectionData.playerInteraction=!0),(i.keyPressed[38]||i.keyPressed[87])&&(i.movementDirectionData.vector.y-=1,i.movementDirectionData.playerInteraction=!0),(i.keyPressed[39]||i.keyPressed[68])&&(i.movementDirectionData.vector.x+=1,i.movementDirectionData.playerInteraction=!0),(i.keyPressed[40]||i.keyPressed[83])&&(i.movementDirectionData.vector.y+=1,i.movementDirectionData.playerInteraction=!0),i.movementDirectionData}},t.exports=i},{"./theatre":6}],3:[function(e,t,n){t.exports={vectorSubstract:function(e,t){return{x:e.x-t.x,y:e.y-t.y}}}},{}],4:[function(e,t,n){t.exports={tileSize:50,datGuiIsOn:!1,physicsDebugMode:!1,debugWorldCollisions:!1,soundEngineOn:!0,alloweBackgroundMusic:!1,backgroundMusicVolume:.1,effectMusicVolume:1,theatreMovesWithPlayer:!0}},{}],5:[function(e,t,n){var o,i,r;o=e("../../vendors/howler.min"),i=e("./settings"),o=o.Howl,(r={effects:{},backgroundSong:void 0,init:function(){i.soundEngineOn&&(r.addEffect("colide","sounds/jump.ogg",.03),r.addEffect("hello","sounds/hello.ogg",.03),r.addEffect("walk","sounds/walk.ogg",.7),r.addEffect("running","sounds/walk.ogg",1),r.addEffect("wind","sounds/breath.ogg",.4),i.alloweBackgroundMusic&&(r.backgroundSong=new o({src:["sounds/inside.mp3"],loop:!0,volume:i.backgroundMusicVolume})))},addEffect:function(e,t,n){r.effects[e]=r.createEffect(t,n*i.effectMusicVolume)},createEffect:function(e,t){var n={isPlaying:!1,howl:new o({src:[e],volume:t,onend:function(){n.isPlaying=!1}}),play:function(e){e&&n.isPlaying||(n.isPlaying=!0,n.howl.play())}};return n},playEffect:function(e,t){if(i.soundEngineOn){var n=r.effects[e];n&&n.play(t)}},playBackgroundSound:function(){i.alloweBackgroundMusic&&r.backgroundSong.play()},pauseBackgroundSound:function(){i.alloweBackgroundMusic&&r.backgroundSong.pause()}}).init(),t.exports=r},{"../../vendors/howler.min":22,"./settings":4}],6:[function(n,o,e){!function(){var e=n("./ui"),c={stageCanvas:void 0,stage:void 0,gridCanvas:void 0,grid:void 0,backdropCanvas:void 0,backdrop:void 0,scale:4,canvasBoxLeft:0,canvasBoxTop:0,canvasBoxRight:0,canvasBoxBottom:0,shakeDuration:50,shakeStartTime:-1,allowScreenShake:!1,scrrenShakeMagnitude:5,useResolutionDevider:!1,resolutionDevider:2,movesWithPlayer:!1,currentTranslateX:0,currentTranslateY:0,worldNeedsRedraw:!0,canvasHeight:400,canvasWidth:400,init:function(e){c.movesWithPlayer=e,c.stageCanvas=document.getElementById("Stage"),c.stage=c.stageCanvas.getContext("2d"),c.gridCanvas=document.getElementById("Grid"),c.grid=c.gridCanvas.getContext("2d"),c.backdropCanvas=document.getElementById("Backdrop"),c.backdrop=c.backdropCanvas.getContext("2d"),c.waterCanvas=document.getElementById("Water-Container"),c.waterCanvas.style.width=c.canvasWidth+"px",c.waterCanvas.style.height=c.canvasHeight+"px",c.waterCanvas,c.resize(),window.addEventListener("resize",c.resize,!1)},resize:function(){c.setSize(c.stageCanvas),c.setSize(c.gridCanvas),c.setSize(c.backdropCanvas)},setSize:function(e){c.useResolutionDevider?(e.className+=" scaleCanvas",e.width=c.canvasWidth/c.resolutionDevider,e.height=c.canvasHeight/c.resolutionDevider,e.style.transformOrigin="0% 0%",e.style.transform="scale("+c.resolutionDevider+", "+c.resolutionDevider+")"):(e.width=c.canvasWidth,e.height=c.canvasHeight,c.canvasBoxLeft=0,c.canvasBoxTop=0,c.canvasBoxBottom=e.height,c.canvasBoxRight=e.width)},setScale:function(){c.stage.scale(c.scale,c.scale),c.grid.scale(c.scale,c.scale),c.backdrop.scale(c.scale,c.scale)},clearStage:function(){c.movesWithPlayer,c.stage.clearRect(c.canvasBoxLeft,c.canvasBoxTop,c.canvasBoxRight-c.canvasBoxLeft,c.canvasBoxBottom-c.canvasBoxTop),c.movesWithPlayer&&c.backdrop.clearRect(c.canvasBoxLeft,c.canvasBoxTop,c.canvasBoxRight-c.canvasBoxLeft,c.canvasBoxBottom-c.canvasBoxTop)},clearWorld:function(){c.backdrop.clearRect(c.canvasBoxLeft,c.canvasBoxTop,c.canvasBoxRight,c.canvasBoxBottom)},clearGrid:function(){c.grid.clearRect(0,0,c.gridCanvas.width,c.gridCanvas.height)},drawGrids:function(){c.clearGrid(),c.drawGrid(.5,10,"gray"),c.drawGrid(1,100,"black")},preShake:function(){if(c.allowScreenShake){if(-1==c.shakeStartTime)return;if(Date.now()-c.shakeStartTime>c.shakeDuration)return void(c.shakeStartTime=-1);c.stage.save(),c.backdrop.save();var e=Math.random()*c.scrrenShakeMagnitude,t=Math.random()*c.scrrenShakeMagnitude;c.stage.translate(e,t),c.backdrop.translate(e,t)}},postShake:function(){if(c.allowScreenShake){if(-1==c.shakeStartTime)return;c.stage.restore(),c.backdrop.restore()}},startShake:function(){c.allowScreenShake&&(c.shakeStartTime=Date.now())},playerUpdate:function(e){if(c.movesWithPlayer){var t=c.stageCanvas.width/2-e.x,n=c.stageCanvas.height/2-e.y;c.stage.setTransform(1,0,0,1,t,n),c.backdrop.setTransform(1,0,0,1,t,n),c.canvasBoxLeft=e.x-c.stageCanvas.width/2,c.canvasBoxRight=e.x+c.stageCanvas.width/2,c.canvasBoxTop=e.y-c.stageCanvas.height/2,c.canvasBoxBottom=e.y+c.stageCanvas.height/2,c.worldNeedsRedraw=!0}else e.x<c.canvasBoxLeft?(c.currentTranslateX+=c.canvasWidth,c.stage.setTransform(1,0,0,1,c.currentTranslateX,c.currentTranslateY),c.backdrop.setTransform(1,0,0,1,c.currentTranslateX,c.currentTranslateY),c.canvasBoxLeft-=c.canvasWidth,c.canvasBoxRight-=c.canvasWidth,c.worldNeedsRedraw=!0):e.x>c.canvasBoxRight?(c.currentTranslateX-=c.canvasWidth,c.stage.setTransform(1,0,0,1,c.currentTranslateX,c.currentTranslateY),c.backdrop.setTransform(1,0,0,1,c.currentTranslateX,c.currentTranslateY),c.canvasBoxLeft+=c.canvasWidth,c.canvasBoxRight+=c.canvasWidth,c.worldNeedsRedraw=!0):e.y<c.canvasBoxTop?(c.currentTranslateY+=c.canvasHeight,c.stage.setTransform(1,0,0,1,c.currentTranslateX,c.currentTranslateY),c.backdrop.setTransform(1,0,0,1,c.currentTranslateX,c.currentTranslateY),c.canvasBoxTop-=c.canvasHeight,c.canvasBoxBottom-=c.canvasHeight,c.worldNeedsRedraw=!0):e.y>c.canvasBoxBottom&&(c.currentTranslateY-=c.canvasHeight,c.stage.setTransform(1,0,0,1,c.currentTranslateX,c.currentTranslateY),c.backdrop.setTransform(1,0,0,1,c.currentTranslateX,c.currentTranslateY),c.canvasBoxTop+=c.canvasHeight,c.canvasBoxBottom+=c.canvasHeight,c.worldNeedsRedraw=!0)},drawGrid:function(e,t,n){var o=c.gridCanvas.width,i=c.gridCanvas.height;c.grid.beginPath();for(var r=0;r<=o;r+=t)c.grid.moveTo(r,0),c.grid.lineTo(r,i);for(var a=0;a<=i;a+=t)c.grid.moveTo(0,a),c.grid.lineTo(o,a);c.grid.strokeStyle=n,c.grid.lineWidth=e,c.grid.stroke()},drawTrianlgeFromCenter:function(e,t,n){c.isOutsideOfCanvas(t.x+t.halfWidth,t.x-t.halfWidth,t.y-t.halfHeight,t.y+t.halfHeight)||(c[e].beginPath(),c[e].moveTo(Math.floor(t.x),Math.floor(t.y-t.halfHeight)),c[e].lineTo(Math.floor(t.x-t.halfWidth),Math.floor(t.y+t.halfHeight)),c[e].lineTo(Math.floor(t.x+t.halfWidth),Math.floor(t.y+t.halfHeight)),c[e].lineTo(Math.floor(t.x),Math.floor(t.y-t.halfHeight)),c[e].fillStyle=n,c[e].fill())},drawTrianlgeFromCenterUpsideDown:function(e,t,n){c.isOutsideOfCanvas(t.x+t.halfWidth,t.x-t.halfWidth,t.y-t.halfHeight,t.y+t.halfHeight)||(c[e].beginPath(),c[e].moveTo(Math.floor(t.x),Math.floor(t.y+t.halfHeight)),c[e].lineTo(Math.floor(t.x-t.halfWidth),Math.floor(t.y-t.halfHeight)),c[e].lineTo(Math.floor(t.x+t.halfWidth),Math.floor(t.y-t.halfHeight)),c[e].lineTo(Math.floor(t.x),Math.floor(t.y+t.halfHeight)),c[e].fillStyle=n,c[e].fill())},drawSquareFromCenter:function(e,t,n){c.isOutsideOfCanvas(t.x+t.halfWidth,t.x-t.halfWidth,t.y-t.halfHeight,t.y+t.halfHeight)||(c[e].fillStyle=n,c[e].fillRect(Math.floor(t.x-t.halfWidth),Math.floor(t.y-t.halfHeight),t.width,t.height))},drawSquareFromLeftTopCorner:function(e,t,n,o){c.isOutsideOfCanvas(t.x+n,t.x,t.y,t.y+n)||(c[e].fillStyle=o,c[e].fillRect(Math.floor(t.x),Math.floor(t.y),n,n))},drawCircle:function(e,t,n){c.isOutsideOfCanvas(t.x+t.halfWidth,t.x-t.halfWidth,t.y-t.halfHeight,t.y+t.halfHeight)||(c[e].beginPath(),c[e].arc(Math.floor(t.x),Math.floor(t.y),t.halfWidth,0,2*Math.PI,!1),c[e].fillStyle=n,c[e].fill())},drawLine:function(e,t,n,o){c[e].beginPath(),c[e].strokeStyle=o,c[e].lineWidth=1,c[e].moveTo(Math.floor(t.x),Math.floor(t.y)),c[e].lineTo(Math.floor(t.x+n),Math.floor(t.y)),c[e].stroke()},drawLineWithVector:function(e,t,n,o){c[e].beginPath(),c[e].strokeStyle=o,c[e].lineWidth=1,c[e].moveTo(Math.floor(t.x),Math.floor(t.y)),c[e].lineTo(Math.floor(t.x+n.x),Math.floor(t.y+n.y)),c[e].stroke()},drawPath:function(e,t,n,o,i,r,a){var s=t[n];if(null!=s){c[e].beginPath(),c[e].strokeStyle=o,c[e].lineWidth=Math.floor(i),c[e].moveTo(Math.floor(s.x),Math.floor(s.y));for(var l=0,d=n;l<r;l++)null!=(s=t[d])&&(c[e].lineTo(Math.floor(s.x),Math.floor(s.y)),d=(d+1)%r);a&&c[e].lineTo(Math.floor(a.x),Math.floor(a.y)),c[e].stroke()}},drawMultipleLines:function(e,t,n){c[e].beginPath(),c[e].strokeStyle=n;for(var o=t.length-1;0<=o;o--)c[e].moveTo(Math.floor(t[o].lineStartX),Math.floor(t[o].lineStartY)),c[e].lineTo(Math.floor(t[o].lineEndX),Math.floor(t[o].lineEndY));c[e].stroke()},isOutsideOfCanvas:function(e,t,n,o){return!(c.canvasBoxLeft<e&&c.canvasBoxRight>t&&c.canvasBoxTop<o&&c.canvasBoxBottom>n)},adjustPositionToStage:function(e){e.x=c.canvasBoxLeft+e.x,e.y=c.canvasBoxTop+e.y}};if(e.datGui){var t=e.datGui.addFolder("theatre");t.add(c,"allowScreenShake"),t.add(c,"scrrenShakeMagnitude"),t.add(c,"shakeDuration"),t.add(c,"startShake"),t.add(c,"drawGrids"),t.add(c,"clearGrid"),t.add(c,"scale"),t.add(c,"setScale")}o.exports=c}()},{"./ui":7}],7:[function(e,t,n){var o,i,r;o=e("../../vendors/dat.gui.min"),i=e("./settings"),r={menu:document.getElementById("Menu"),continueBtn:document.getElementById("continue"),datGui:i.datGuiIsOn?new o.GUI:void 0,init:function(e){r.continueBtn.addEventListener("click",function(){e()})},openMenu:function(){r.menu.className=""},closeMenu:function(){r.menu.className="hide"}},t.exports=r},{"../../vendors/dat.gui.min":21,"./settings":4}],8:[function(e,t,n){var o;o={vectorToDegree:function(e){return 180*o.vectorToRadiant(e)/Math.pi},vectorToRadiant:function(e){return Math.atan2(e.x,e.y)},vectorLength:function(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))},scaleVectorBy:function(e,t){return o.shrinkVectorToLength(e,o.vectorLength(e)*t)},shrinkVectorToLength:function(e,t){return(e=o.setVectorToLengthOne(e)).x*=t,e.y*=t,e},getVectorAngleDegree:function(e,t){return 180*(Math.atan2(t.y,t.x)-Math.atan2(e.y,e.x))/Math.PI},setVectorToLengthOne:function(e){if(0<o.vectorLength(e)){var t=o.vectorToRadiant(e);e.x=Math.sin(t),e.y=Math.cos(t)}return e}},t.exports=o},{}],9:[function(e,t,n){var s,l;s=e("./../managers/entityManager"),l={add:function(e){e.entityCollisions=[]},update:function(){for(var e=s.visableEntities.length-1;0<=e;e--)for(var t=s.visableEntities[e].id,n=s.enitites[t],o=s.tree.retrieveInBounds(s.visableEntities[e]),i=o.length-1;0<=i;i--){var r=o[i].id,a=s.enitites[r];r!=t&&(l.collsitionDetectionOfTwoEntities(n,a)?(null!=n.entityCollisions[a.Id]&&!n.entityCollisions[a.Id]||null!=a.entityCollisions[n.Id]&&!a.entityCollisions[n.Id])&&(l.calculateEntitiesCollisionReaction(n,a),n.entityCollisions[a.Id]=!0,a.entityCollisions[n.Id]=!0):(n.entityCollisions[a.Id]=!1,a.entityCollisions[n.Id]=!1))}},calculateEntitiesCollisionReaction:function(e,t){var n=(e.physics.velocity.x*(e.physics.mass-t.physics.mass)+2*t.physics.mass*t.physics.velocity.x)/(e.physics.mass+t.physics.mass),o=(e.physics.velocity.y*(e.physics.mass-t.physics.mass)+2*t.physics.mass*t.physics.velocity.y)/(e.physics.mass+t.physics.mass),i=(t.physics.velocity.x*(t.physics.mass-e.physics.mass)+2*e.physics.mass*e.physics.velocity.x)/(e.physics.mass+t.physics.mass),r=(t.physics.velocity.y*(t.physics.mass-e.physics.mass)+2*e.physics.mass*e.physics.velocity.y)/(e.physics.mass+t.physics.mass);e.physics.setVelocity(n,o),t.physics.setVelocity(i,r)},collsitionDetectionOfTwoEntities:function(e,t){var n=e.physics.getHitBox(),o=t.physics.getHitBox();return n.Left<o.Right&&n.Right>o.Left&&n.Top<o.Bottom&&n.Bottom>o.Top},isEntityCollidingWithOtherEntites:function(e){for(var t=e.entityCollisions.length-1;0<=t;t--)if(null!=e.entityCollisions[t]&&e.entityCollisions[t])return!0;return!1}},t.exports=l},{"./../managers/entityManager":16}],10:[function(e,t,n){var d,o,c,u,h;d=e("./../helpers/tilesHelper"),o=e("./../core/theatre"),c=e("./../core/sound"),u=e("./../core/settings"),h={collsitions:[],checkLines:[],collsitionDetection:function(e,t,n,o,i,r){d.calculateNeahrestTileWalls(e,t,n,o.centerPosition);for(var a=!1,s=d.neahrestTileWalls.length-1;0<=s;s--)if(d.neahrestTileWalls[s])for(var l=d.neahrestTileWalls[s].length-1;0<=l;l--)a=h.calculateWallCollsitionDenfung(d.neahrestTileWalls[s][l],o,i,r)||a;return a},calculateWallCollsitionDenfung:function(e,t,n,o){for(var i=t.points.length-1;0<=i;i--)if(h.checkLineIntersectionFast(e[0].x,e[0].y,e[1].x,e[1].y,t.points[i].x,t.points[i].y,t.points[i].x+n.x,t.points[i].y+n.y)){u.debugWorldCollisions&&h.debugCollisionLine(e[0].x,e[0].y,e[1].x,e[1].y),c.playEffect("colide",!0);for(var r=!0,a=!0,s=!0,l=!0,d=t.points.length-1;0<=d;d--)r=r&&e[0].x<t.points[d].x&&e[1].x<t.points[d].x,a=a&&e[0].x>t.points[d].x&&e[1].x>t.points[d].x,s=s&&e[0].y<t.points[d].y&&e[1].y<t.points[d].y,l=l&&e[0].y>t.points[d].y&&e[1].y>t.points[d].y;return o?(a&&0<n.x&&(n.x=-n.x),r&&n.x<0&&(n.x=-n.x),l&&0<n.y&&(n.y=-n.y),s&&n.y<0&&(n.y=-n.y)):((a||r)&&(n.x=0),(l||s)&&(n.y=0)),!0}return!1},checkLineIntersectionFast:function(e,t,n,o,i,r,a,s){u.debugWorldCollisions&&h.debugLine(e,t,n,o,i,r,a,s);var l=(n-e)*(s-r)-(a-i)*(o-t);if(0===l)return!1;var d=((s-r)*(a-e)+(i-a)*(s-t))/l,c=((t-o)*(a-e)+(n-e)*(s-t))/l;return 0<d&&d<1&&0<c&&c<1},update:function(){u.debugWorldCollisions&&(h.collsitions=[],h.checkLines=[])},draw:function(){u.debugWorldCollisions&&(o.drawMultipleLines("stage",h.checkLines,"#F24962"),o.drawMultipleLines("stage",h.collsitions,"blue"))},debugLine:function(e,t,n,o,i,r,a,s){h.checkLines.push({lineStartX:e,lineStartY:t,lineEndX:n,lineEndY:o}),h.checkLines.push({lineStartX:i,lineStartY:r,lineEndX:a,lineEndY:s})},debugCollisionLine:function(e,t,n,o){h.collsitions.push({lineStartX:e,lineStartY:t,lineEndX:n,lineEndY:o})}},t.exports=h},{"./../core/settings":4,"./../core/sound":5,"./../core/theatre":6,"./../helpers/tilesHelper":15}],11:[function(e,t,n){var r,o;r=e("./../core/theatre"),o=e("./../core/util"),t.exports=function(e){var i={color:(e=e||{}).color||"#B0A183",defaultFace:void 0,currentFace:void 0,faceExpressionDuration:200,faceExpressionStartTime:0,positions:void 0,leftEyePosition:{x:0,y:0},rightEyePosition:{x:0,y:0},mouthPosition:{x:0,y:0},compareVector:{x:0,y:-1},eyeSize:0,mouthCloseSize:0,mouthOpenSize:0,init:function(e){i.defaultFace=i.drawNoramlFace,i.currentFace=i.drawNoramlFace,i.eyeSize=.2*e,i.mouthOpenSize=.2*e,i.mouthCloseSize=.4*e},addToDatGuiFolder:function(e){var t=e.addFolder("Face");t.add(i,"faceExpressionDuration"),t.add(i,"faceExpressionStartTime").listen()},update:function(e,t){if(e.collsition)i.SetSurpiseFace();else if(e.isMoving)if(i.faceExpressionStartTime);else if(t){var n=o.getVectorAngleDegree(i.compareVector,e.velocity);-30<n&&n<30?i.SetFaceLookTop():150<n&&n<210?i.SetFaceLookDown():n<180&&2<n?i.SetFaceLookRight():(n<-2||2<n&&180!=n)&&i.SetFaceLookLeft()}i.faceExpressionStartTime&&Date.now()-i.faceExpressionStartTime>i.faceExpressionDuration&&(i.currentFace=i.drawNoramlFace,i.faceExpressionStartTime=void 0),.995<Math.random()&&i.setNoramlFaceOpenEyes()},draw:function(e){i.currentFace(e)},SetSurpiseFace:function(){i.faceExpressionStartTime=Date.now(),i.currentFace=i.drawSurpiseFace},SetFaceLookLeft:function(){i.faceExpressionStartTime=Date.now(),i.currentFace=i.drawFaceLookLeft},SetFaceLookRight:function(){i.faceExpressionStartTime=Date.now(),i.currentFace=i.drawFaceLookRight},SetFaceLookTop:function(){i.faceExpressionStartTime=Date.now(),i.currentFace=i.drawFaceLookTop},SetFaceLookDown:function(){i.faceExpressionStartTime=Date.now(),i.currentFace=i.drawFaceLookDown},setNoramlFaceOpenEyes:function(){i.faceExpressionStartTime=Date.now(),i.currentFace=i.drawNoramlFaceOpenEyes},drawNoramlFace:function(e){i.leftEyePosition.x=e.x-.3*e.width,i.leftEyePosition.y=e.y-.1*e.height,r.drawLine("stage",i.leftEyePosition,i.eyeSize,i.color),i.rightEyePosition.x=e.x+.1*e.width,i.rightEyePosition.y=e.y-.1*e.height,r.drawLine("stage",i.rightEyePosition,i.eyeSize,i.color),i.mouthPosition.x=e.x-.2*e.width,i.mouthPosition.y=e.y+.3*e.height,r.drawLine("stage",i.mouthPosition,i.mouthCloseSize,i.color)},drawNoramlFaceOpenEyes:function(e){i.leftEyePosition.x=e.x-.3*e.width,i.leftEyePosition.y=e.y-.2*e.height,r.drawSquareFromLeftTopCorner("stage",i.leftEyePosition,i.eyeSize,i.color),i.rightEyePosition.x=e.x+.1*e.width,i.rightEyePosition.y=e.y-.2*e.height,r.drawSquareFromLeftTopCorner("stage",i.rightEyePosition,i.eyeSize,i.color),i.mouthPosition.x=e.x-.2*e.width,i.mouthPosition.y=e.y+.3*e.height,r.drawLine("stage",i.mouthPosition,i.mouthCloseSize,i.color)},drawSurpiseFace:function(e){i.leftEyePosition.x=e.x-.3*e.width,i.leftEyePosition.y=e.y-.2*e.height,r.drawSquareFromLeftTopCorner("stage",i.leftEyePosition,i.eyeSize,i.color),i.rightEyePosition.x=e.x+.1*e.width,i.rightEyePosition.y=e.y-.2*e.height,r.drawSquareFromLeftTopCorner("stage",i.rightEyePosition,i.eyeSize,i.color),i.mouthPosition.x=e.x-.1*e.width,i.mouthPosition.y=e.y+.2*e.height,r.drawSquareFromLeftTopCorner("stage",i.mouthPosition,i.mouthOpenSize,i.color)},drawFaceLookLeft:function(e){i.leftEyePosition.x=e.x-.4*e.width,i.leftEyePosition.y=e.y-.2*e.height,i.rightEyePosition.x=e.x,i.rightEyePosition.y=e.y-.2*e.height,i.drawFaceLook(e)},drawFaceLookRight:function(e){i.leftEyePosition.x=e.x-.2*e.width,i.leftEyePosition.y=e.y-.2*e.height,i.rightEyePosition.x=e.x+.2*e.width,i.rightEyePosition.y=e.y-.2*e.height,i.drawFaceLook(e)},drawFaceLookTop:function(e){i.leftEyePosition.x=e.x-.3*e.width,i.leftEyePosition.y=e.y-.25*e.height,i.rightEyePosition.x=e.x+.1*e.width,i.rightEyePosition.y=e.y-.25*e.height,i.drawFaceLook(e)},drawFaceLookDown:function(e){i.leftEyePosition.x=e.x-.3*e.width,i.leftEyePosition.y=e.y-.15*e.height,i.rightEyePosition.x=e.x+.1*e.width,i.rightEyePosition.y=e.y-.15*e.height,i.drawFaceLook(e)},drawFaceLook:function(e){var t=e.isRunning?2:1.1,n=(Math.random()-.5)*t,o=(Math.random()-.5)*t;i.leftEyePosition.x+=n,i.leftEyePosition.y+=o,i.rightEyePosition.x+=n,i.rightEyePosition.y+=o,r.drawSquareFromLeftTopCorner("stage",i.leftEyePosition,i.eyeSize,i.color),r.drawSquareFromLeftTopCorner("stage",i.rightEyePosition,i.eyeSize,i.color),i.mouthPosition.x=e.x-.2*e.width+n,i.mouthPosition.y=e.y+.3*e.height+o,r.drawLine("stage",i.mouthPosition,i.mouthCloseSize,i.color)}};return i}},{"./../core/theatre":6,"./../core/util":8}],12:[function(e,t,n){var r;r=e("./../core/theatre"),t.exports=function(e){var o={},i={positions:[],maxLength:5,lastTimeSet:0,setTimeDelay:(e=e||{}).setTimeDelay||50,lastEntityIndex:0,onlyUpdateIfMoving:!1,lineWidth:1,shouldDrawLine:!0,shouldDrawBodies:void 0===e.shouldDrawBodies||e.shouldDrawBodies,color:e.color||{r:253,g:244,b:194},addToDatGuiFolder:function(e){var t=e.addFolder("LastPositions");t.add(i,"maxLength"),t.add(i,"lastTimeSet").listen(),t.add(i,"setTimeDelay"),t.add(i,"lastEntityIndex").listen(),t.add(i,"onlyUpdateIfMoving"),t.add(i,"lineWidth"),t.add(i,"drawLine"),t.add(i,"drawBodies")},clear:function(){i.positions=[],i.lastEntityIndex=0,i.lastTimeSet=0},update:function(e){i.onlyUpdateIfMoving&&!e.isMoving||Date.now()-i.lastTimeSet>i.setTimeDelay&&(void 0===i.positions[i.lastEntityIndex]&&(i.positions[i.lastEntityIndex]={x:0,y:0}),i.positions[i.lastEntityIndex].x=e.x,i.positions[i.lastEntityIndex].y=e.y,i.lastEntityIndex=(i.lastEntityIndex+1)%i.maxLength,i.lastTimeSet=Date.now())},draw:function(e){i.shouldDrawBodies&&i.drawBodies(e),i.shouldDrawLine&&i.drawLine(e)},drawBodies:function(e){for(var t=0,n=i.lastEntityIndex;t<i.maxLength;t++)null!=i.positions[n]&&(o.x=i.positions[n].x,o.y=i.positions[n].y,o.halfWidth=e.halfWidth,o.halfHeight=e.halfHeight,o.width=e.width,o.height=e.height,r.drawSquareFromCenter("stage",o,"rgba("+i.color.r+", "+i.color.g+", "+i.color.b+", "+t*(.5/i.maxLength)+"0.1)"),n=(n+1)%i.maxLength)},drawLine:function(e){r.drawPath("stage",i.positions,i.lastEntityIndex,"rgba("+i.color.r+", "+i.color.g+", "+i.color.b+", 0.6)",i.lineWidth,i.maxLength,e)}};return i}},{"./../core/theatre":6}],13:[function(e,t,n){var o,i,r,a;o=e("./../core/util"),i=e("./../systems/world"),r=e("./../core/settings"),a=e("./../core/theatre"),t.exports=function(e){var n={x:(e=e||{}).x||0,y:e.y||0,velocity:e.velocity||{x:0,y:0},speed:e.speed||2,runSpeed:e.runSpeed||4,mass:e.mass||1,height:e.height||20,width:e.width||20,isBounce:e.isBounce||!1,isFrictionless:null!=e.isFrictionless&&e.isFrictionless,frictionMagnitude:e.frictionMagnitude||.5,canWorldColide:null==e.canWorldColide||e.canWorldColide,isMoving:!1,angle:0,maxVelocity:void 0,halfWidth:void 0,halfHeight:void 0,isRunning:!1,collsition:!1,hitBox:void 0,currentSpeed:0,init:function(){n.createHitBox(),n.halfHeight=n.height/2,n.halfWidth=n.width/2},addToDatGuiFolder:function(e){var t=e.addFolder("Physics");t.add(n,"speed"),t.add(n,"runSpeed"),t.add(n,"isBounce"),t.add(n,"angle"),t.add(n,"mass"),t.add(n,"currentSpeed").listen(),t.add(n,"isFrictionless"),t.add(n,"frictionMagnitude"),t.add(n,"x").listen(),t.add(n,"y").listen(),t.add(n,"collsition").listen(),t.add(n,"isMoving").listen(),t.add(n,"isRunning").listen(),t.add(n.velocity,"x").listen(),t.add(n.velocity,"y").listen()},calculateFriction:function(){n.isFrictionless||(.1<n.currentSpeed?n.lowerVelocityTo(n.currentSpeed-n.frictionMagnitude):n.setVelocity(0,0))},inputUpdate:function(e){e&&(n.isRunning=e.isRunning,n.maxVelocity=n.isRunning?n.runSpeed:n.speed,n.addVelocity(e.vector.x*(n.maxVelocity/2),e.vector.y*(n.maxVelocity/2)),n.currentSpeed>n.maxVelocity?n.lowerVelocityTo(n.maxVelocity):n.currentSpeed<.2&&n.setVelocity(0,0))},update:function(e){n.isMoving=!1,n.collsition=!1,n.calculateFriction(),n.inputUpdate(e),0<n.currentSpeed&&(n.isMoving=!0,n.collsition=n.collsitionDetection(),n.x+=n.velocity.x,n.y+=n.velocity.y)},draw:function(){r.physicsDebugMode&&n.drawDebugInfo()},createHitBox:function(){n.hitBox={centerPosition:{},Left:void 0,Right:void 0,Bottom:void 0,Top:void 0,points:[{x:void 0,y:void 0},{x:void 0,y:void 0},{x:void 0,y:void 0},{x:void 0,y:void 0}]}},getHitBox:function(){return n.hitBox.centerPosition.x=n.x,n.hitBox.centerPosition.y=n.y,n.hitBox.Left=n.x-n.halfWidth,n.hitBox.Right=n.x+n.halfWidth,n.hitBox.Bottom=n.y+n.halfHeight,n.hitBox.Top=n.y-n.halfHeight,n.hitBox.points[0].x=n.hitBox.Left,n.hitBox.points[0].y=n.hitBox.Top,n.hitBox.points[1].x=n.hitBox.Left,n.hitBox.points[1].y=n.hitBox.Bottom,n.hitBox.points[2].x=n.hitBox.Right,n.hitBox.points[2].y=n.hitBox.Top,n.hitBox.points[3].x=n.hitBox.Right,n.hitBox.points[3].y=n.hitBox.Bottom,n.hitBox},collsitionDetection:function(){return!!n.canWorldColide&&i.collsitionDetection(n.getHitBox(),n.velocity,n.isBounce)},drawDebugInfo:function(){a.drawLineWithVector("stage",n,{x:20*n.velocity.x,y:20*n.velocity.y},"red")},addVelocity:function(e,t){n.velocity.x+=e,n.velocity.y+=t,n.calculateSpeed()},setVelocity:function(e,t){n.velocity.x=e,n.velocity.y=t,n.calculateSpeed()},lowerVelocityTo:function(e){o.shrinkVectorToLength(n.velocity,e),n.calculateSpeed()},calculateSpeed:function(){n.currentSpeed=o.vectorLength(n.velocity)}};return n.init(),n}},{"./../core/settings":4,"./../core/theatre":6,"./../core/util":8,"./../systems/world":19}],14:[function(e,t,n){t.exports={settings:e("./core/settings"),input:e("./core/input"),theatre:e("./core/theatre"),ui:e("./core/ui"),sound:e("./core/sound"),util:e("./core/util"),game:e("./core/game"),face:e("./entityPlugins/face"),physics:e("./entityPlugins/physics"),wind:e("./systems/wind"),math:e("./core/math"),world:e("./systems/world"),lastPositions:e("./entityPlugins/lastPositions"),entityManager:e("./managers/entityManager"),entityCollisionDetection:e("./detectors/entityCollisionDetection")}},{"./core/game":1,"./core/input":2,"./core/math":3,"./core/settings":4,"./core/sound":5,"./core/theatre":6,"./core/ui":7,"./core/util":8,"./detectors/entityCollisionDetection":9,"./entityPlugins/face":11,"./entityPlugins/lastPositions":12,"./entityPlugins/physics":13,"./managers/entityManager":16,"./systems/wind":18,"./systems/world":19}],15:[function(e,t,n){var l,c,u;l=e("./../core/theatre"),c=e("./../core/settings"),u={tileWalls:[],neahrestTileWalls:[],calculateMapWithTileTypes:function(e,t,n){for(var o=[],i=0;i<n;i++)for(var r=0;r<t;r++){var a=i*t+r;if(1==e[a]){var s=0;0<i&&1==e[(i-1)*t+r]&&(s|=1),r<t-1&&1==e[i*t+r+1]&&(s|=2),i<n-1&&1==e[(i+1)*t+r]&&(s|=4),0<r&&1==e[i*t+r-1]&&(s|=8),o[a]=s+1}else o[a]=0}return o},calculateNeahrestTileWalls:function(e,t,n,o){for(var i=0,r=Math.floor(Math.floor(o.x)/c.tileSize),a=Math.floor(Math.floor(o.y)/c.tileSize),s=r-1;s<=r+1;s++)for(var l=a-1;l<=a+1;l++)u.neahrestTileWalls[i++]=s<0||l<0||t<=s||n<=l?void 0:u.addTileWalls(e,s,l,t)},addTileWalls:function(e,t,n,o){if(null==u.tileWalls[n*o+t]){var i=e[n*o+t]-1,r=[],a={x:t*c.tileSize,y:n*c.tileSize},s={x:a.x+c.tileSize,y:a.y},l={x:a.x+c.tileSize,y:a.y+c.tileSize},d={x:a.x,y:a.y+c.tileSize};0==(1&i)&&r.push([a,s]),0==(2&i)&&r.push([s,l]),0==(4&i)&&r.push([d,l]),0==(8&i)&&r.push([a,d]),u.tileWalls[n*o+t]=r}return u.tileWalls[n*o+t]},drawTiles:function(e,t,n){var o=Math.floor(Math.floor(l.canvasBoxLeft)/c.tileSize),i=Math.floor(Math.floor(l.canvasBoxTop)/c.tileSize),r=Math.floor(Math.floor(l.canvasBoxRight)/c.tileSize),a=Math.floor(Math.floor(l.canvasBoxBottom)/c.tileSize);o<0&&(o=0),i<0&&(i=0),r<0&&(r=0),a<0&&(a=0),t-1<o&&(o=t-1),n-1<i&&(i=n-1),t-1<r&&(r=t-1),n-1<a&&(a=n-1);var s={};for(y=i;y<=a;y++)for(x=o;x<=r;x++){if(0!==e[y*t+x]){c.tileSize,c.tileSize;s.x=x*c.tileSize,s.y=y*c.tileSize,l.drawSquareFromLeftTopCorner("backdrop",s,c.tileSize,"#CCDDAF")}}},drawGrass:function(e,t,n){for(var o=10;0<=o;o--){var i={x:e.x+(Math.random()*t-10+5),y:e.y+(Math.random()*n-10+5)};l.drawSquareFromLeftTopCorner("backdrop",i,5,"rgba(167,191,127,0.3)")}}},t.exports=u},{"./../core/settings":4,"./../core/theatre":6}],16:[function(e,t,n){var o,i,d,c;o=e("../../vendors/QuadTree"),i=e("../core/theatre"),d=e("../core/util"),c={enitites:[],visableEntities:[],tree:new(o=o.QuadTree)({x:0,y:0,width:14e3,height:13e3}),add:function(e){var t=c.enitites.length;e.Id=t,e.physics.id=t,c.enitites[t]=e},update:function(){c.visableEntities=c.tree.retrieveInBounds({x:i.canvasBoxLeft,y:i.canvasBoxTop,width:i.canvasWidth,height:i.canvasHeight});for(var e=c.enitites.length-1;0<=e;e--)c.enitites[e].update();c.tree.clear();for(var t=c.enitites.length-1;0<=t;t--)c.tree.insert(c.enitites[t].physics)},postUpdate:function(){for(var e=c.enitites.length-1;0<=e;e--)c.enitites[e].postUpdate&&c.enitites[e].postUpdate()},preDraw:function(){for(var e=c.visableEntities.length-1;0<=e;e--){var t=c.visableEntities[e].id;c.enitites[t].preDraw&&c.enitites[t].preDraw()}},draw:function(){for(var e=c.visableEntities.length-1;0<=e;e--){var t=c.visableEntities[e].id;c.enitites[t].draw()}},getNeahrestEntity:function(e,t){var n;t=t||0;for(var o=Number.MAX_SAFE_INTEGER,i=c.visableEntities.length-1;0<=i;i--){var r=c.visableEntities[i].id,a=c.enitites[r];if(e.physics.id!=r){var s={x:e.physics.x-a.physics.x,y:e.physics.y-a.physics.y},l=d.vectorLength(s);l<o&&l<=t&&(n=a,o=l)}}return n}},t.exports=c},{"../../vendors/QuadTree":20,"../core/theatre":6,"../core/util":8}],17:[function(e,t,n){var o,i,a,s;o=e("./../core/theatre"),i=e("./../entityPlugins/physics"),a=e("./../entityPlugins/lastPositions"),s=e("./../core/sound"),t.exports=function(){var r={physics:i({x:0,y:0,height:5,width:5,canWorldColide:!1}),lastPositions:a({shouldDrawBodies:!1,color:{r:255,g:255,b:255}}),isAlive:!1,lifeTime:1500,createdTime:void 0,movementDirectionData:{isRunning:!1,vector:{x:0,y:0}},birth:function(){r.createdTime=Date.now(),r.isAlive=!0,s.playEffect("wind"),r.physics.x=o.canvasBoxLeft+Math.random()*o.stageCanvas.width,r.physics.y=o.canvasBoxTop+Math.random()*o.stageCanvas.height},update:function(e,t){var n=Date.now()-r.createdTime;if(n>r.lifeTime)r.isAlive=!1,r.lastPositions.clear();else{var o=n/(r.lifeTime/2)-1,i=150*(-1*Math.pow(o,2)+1);r.lastPositions.lineWidth=i/150*2,r.lastPositions.setTimeDelay=i,r.lastPositions.update(r.physics),r.physics.speed=t,r.movementDirectionData.vector.x=Math.random()-.5+e.x,r.movementDirectionData.vector.y=Math.random()-.5+e.y,r.physics.update(r.movementDirectionData)}},draw:function(){r.lastPositions.draw(r.physics)}};return r}},{"./../core/sound":5,"./../core/theatre":6,"./../entityPlugins/lastPositions":12,"./../entityPlugins/physics":13}],18:[function(e,t,n){var o,i,r;o=e("./../core/util"),i=e("./WindParticleFactory"),(r={windParticles:[],windDirection:{x:1,y:0},windSpeed:4,maxAliveWindPartiles:10,init:function(){for(var e=0;e<10;e++)r.windParticles.push(i())},incluenceEntityPhysic:function(e,t){.95<Math.random()&&(t.x+=r.windDirection.x*(1/e.mass)/100,t.y+=r.windDirection.y*(1/e.mass)/100)},update:function(){if(.995<Math.random()&&(r.windSpeed=9*Math.random()+1),.95<Math.random()&&(r.windDirection.x=Math.random()-.5+r.windDirection.x,r.windDirection.y=Math.random()-.5+r.windDirection.y,o.setVectorToLengthOne(r.windDirection)),Math.random()>.995-r.windSpeed/100)for(var e=0;e<r.maxAliveWindPartiles;e++)if(!r.windParticles[e].isAlive){r.windParticles[e].birth();break}for(e=0;e<r.maxAliveWindPartiles;e++)r.windParticles[e].isAlive&&r.windParticles[e].update(r.windDirection,r.windSpeed)},draw:function(){for(var e=0;e<r.maxAliveWindPartiles;e++)r.windParticles[e].isAlive&&r.windParticles[e].draw()}}).init(),t.exports=r},{"./../core/util":8,"./WindParticleFactory":17}],19:[function(e,t,n){var o,i,r;o=e("./../helpers/tilesHelper"),i=e("./../detectors/worldCollsitionDetection"),r={map:void 0,worldWith:void 0,wolrdHeight:void 0,mapWithTileTypes:void 0,init:function(e,t,n){r.map=e,r.worldWith=n,r.wolrdHeight=t,r.mapWithTileTypes=o.calculateMapWithTileTypes(r.map,r.worldWith,r.wolrdHeight)},collsitionDetection:function(e,t,n){return i.collsitionDetection(r.mapWithTileTypes,r.worldWith,r.wolrdHeight,e,t,n)},draw:function(){o.drawTiles(r.mapWithTileTypes,r.worldWith,r.wolrdHeight)}},t.exports=r},{"./../detectors/worldCollsitionDetection":10,"./../helpers/tilesHelper":15}],20:[function(e,t,n){!function(e){function r(e,t,n,o){var i;i=t?new s(e,0,n,o):new a(e,0,n,o),this.root=i}function s(e,t,n,o){this._bounds=e,this.children=[],this.nodes=[],o&&(this._maxChildren=o),n&&(this._maxDepth=n),t&&(this._depth=t)}function a(e,t,n,o){s.call(this,e,t,n,o),this._stuckChildren=[]}r.prototype.root=null,r.prototype.insert=function(e){if(e instanceof Array)for(var t=e.length,n=0;n<t;n++)this.root.insert(e[n]);else this.root.insert(e)},r.prototype.clear=function(){this.root.clear()},r.prototype.retrieve=function(e){return this.root.retrieve(e).slice(0)},r.prototype.retrieveInBounds=function(e){var t=this.root.retrieveInBounds(e);return r._filterResults(t,e)},r._filterResults=function(e,t){var n=[];if(this.root instanceof a)for(var o=0;o<e.length;o++){var i=e[o];r._isBoundOverlappingBound(i,t)&&n.push(i)}else for(o=0;o<e.length;o++){i=e[o];r._isPointInsideBounds(i,t)&&n.push(i)}return n},r._isPointInsideBounds=function(e,t){return e.x>=t.x&&e.x<=t.x+t.width&&e.y>=t.y&&e.y<=t.y+t.height},r._isBoundOverlappingBound=function(e,t){return!(e.x>t.x+t.width||t.x>e.x+e.width||e.y>t.y+t.height||t.y>e.y+e.height)},s.prototype.nodes=null,(s.prototype._classConstructor=s).prototype.children=null,s.prototype._bounds=null,s.prototype._depth=0,s.prototype._maxChildren=4,s.prototype._maxDepth=4,s.TOP_LEFT=0,s.TOP_RIGHT=1,s.BOTTOM_LEFT=2,s.BOTTOM_RIGHT=3,s.prototype.insert=function(e){if(this.nodes.length){var t=this._findIndex(e);this.nodes[t].insert(e)}else{this.children.push(e);var n=this.children.length;if(!(this._depth>=this._maxDepth)&&n>this._maxChildren){this.subdivide();for(var o=0;o<n;o++)this.insert(this.children[o]);this.children.length=0}}},s.prototype.retrieve=function(e){if(this.nodes.length){var t=this._findIndex(e);return this.nodes[t].retrieve(e)}return this.children},s.prototype.retrieveInBounds=function(e){var t=[];if(this.collidesWith(e))if(t=t.concat(this._stuckChildren),this.children.length)t=t.concat(this.children);else if(this.nodes.length)for(var n=0;n<this.nodes.length;n++)t=t.concat(this.nodes[n].retrieveInBounds(e));return t},s.prototype.collidesWith=function(e){var t=this._bounds,n=e;return!(t.x>n.x+n.width||n.x>t.x+t.width||t.y>n.y+n.height||n.y>t.y+t.height)},s.prototype._findIndex=function(e){var t=this._bounds,n=!(e.x>t.x+t.width/2),o=!(e.y>t.y+t.height/2),i=s.TOP_LEFT;return n?o||(i=s.BOTTOM_LEFT):i=o?s.TOP_RIGHT:s.BOTTOM_RIGHT,i},s.prototype.subdivide=function(){var e=this._depth+1,t=this._bounds.x,n=this._bounds.y,o=this._bounds.width/2|0,i=this._bounds.height/2|0,r=t+o,a=n+i;this.nodes[s.TOP_LEFT]=new this._classConstructor({x:t,y:n,width:o,height:i},e,this._maxDepth,this._maxChildren),this.nodes[s.TOP_RIGHT]=new this._classConstructor({x:r,y:n,width:o,height:i},e,this._maxDepth,this._maxChildren),this.nodes[s.BOTTOM_LEFT]=new this._classConstructor({x:t,y:a,width:o,height:i},e,this._maxDepth,this._maxChildren),this.nodes[s.BOTTOM_RIGHT]=new this._classConstructor({x:r,y:a,width:o,height:i},e,this._maxDepth,this._maxChildren)},s.prototype.clear=function(){this.children.length=0;for(var e=this.nodes.length,t=0;t<e;t++)this.nodes[t].clear();this.nodes.length=0},((a.prototype=new s)._classConstructor=a).prototype._stuckChildren=null,a.prototype._out=[],a.prototype.insert=function(e){if(this.nodes.length){var t=this._findIndex(e),n=this.nodes[t];e.x>=n._bounds.x&&e.x+e.width<=n._bounds.x+n._bounds.width&&e.y>=n._bounds.y&&e.y+e.height<=n._bounds.y+n._bounds.height?this.nodes[t].insert(e):this._stuckChildren.push(e)}else{this.children.push(e);var o=this.children.length;if(!(this._depth>=this._maxDepth)&&o>this._maxChildren){this.subdivide();for(var i=0;i<o;i++)this.insert(this.children[i]);this.children.length=0}}},a.prototype.getChildren=function(){return this.children.concat(this._stuckChildren)},a.prototype.retrieve=function(e){var t=this._out;if(t.length=0,this.nodes.length){var n=this._findIndex(e);t.push.apply(t,this.nodes[n].retrieve(e))}return t.push.apply(t,this._stuckChildren),t.push.apply(t,this.children),t},a.prototype.clear=function(){this._stuckChildren.length=0,this.children.length=0;var e=this.nodes.length;if(e){for(var t=0;t<e;t++)this.nodes[t].clear();this.nodes.length=0}},e.QuadTree=r}(this)},{}],21:[function(e,t,n){var r,o,i,a,s,l,d,c,u,h,f,p,_,m,g,y,v,b,x,w,S,C,E,T,k,A,M,B,D,L,P,O,F,I,R,H,N,W,V,G,z,U,j,X,Y,q,K,Q,J=J||{};J.gui=J.gui||{},J.utils=J.utils||{},J.controllers=J.controllers||{},J.dom=J.dom||{},J.color=J.color||{},J.utils.css={load:function(e,t){var n=(t=t||document).createElement("link");n.type="text/css",n.rel="stylesheet",n.href=e,t.getElementsByTagName("head")[0].appendChild(n)},inject:function(e,t){t=t||document;var n=document.createElement("style");n.type="text/css",n.innerHTML=e,t.getElementsByTagName("head")[0].appendChild(n)}},J.utils.common=(r=Array.prototype.forEach,o=Array.prototype.slice,{BREAK:{},extend:function(n){return this.each(o.call(arguments,1),function(e){for(var t in e)this.isUndefined(e[t])||(n[t]=e[t])},this),n},defaults:function(n){return this.each(o.call(arguments,1),function(e){for(var t in e)this.isUndefined(n[t])&&(n[t]=e[t])},this),n},compose:function(){var n=o.call(arguments);return function(){for(var e=o.call(arguments),t=n.length-1;0<=t;t--)e=[n[t].apply(this,e)];return e[0]}},each:function(e,t,n){if(r&&e.forEach===r)e.forEach(t,n);else if(e.length===e.length+0)for(var o=0,i=e.length;o<i&&!(o in e&&t.call(n,e[o],o)===this.BREAK);o++);else for(o in e)if(t.call(n,e[o],o)===this.BREAK)break},defer:function(e){setTimeout(e,0)},toArray:function(e){return e.toArray?e.toArray():o.call(e)},isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:function(e){return e!=e},isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return!1===e||!0===e},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)}}),J.controllers.Controller=(i=function(e,t){this.initialValue=e[t],this.domElement=document.createElement("div"),this.object=e,this.property=t,this.__onFinishChange=this.__onChange=void 0},J.utils.common.extend(i.prototype,{onChange:function(e){return this.__onChange=e,this},onFinishChange:function(e){return this.__onFinishChange=e,this},setValue:function(e){return this.object[this.property]=e,this.__onChange&&this.__onChange.call(this,e),this.updateDisplay(),this},getValue:function(){return this.object[this.property]},updateDisplay:function(){return this},isModified:function(){return this.initialValue!==this.getValue()}}),i),J.dom.dom=function(a){function t(e){return"0"===e||a.isUndefined(e)?0:(e=e.match(n),a.isNull(e)?0:parseFloat(e[1]))}var s={};a.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},function(e,t){a.each(e,function(e){s[e]=t})});var n=/(\d+(\.\d+)?)px/,i={makeSelectable:function(e,t){void 0!==e&&void 0!==e.style&&(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(e,t,n){a.isUndefined(t)&&(t=!0),a.isUndefined(n)&&(n=!0),e.style.position="absolute",t&&(e.style.left=0,e.style.right=0),n&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,t,n,o){n=n||{};var i=s[t];if(!i)throw Error("Event type "+t+" not supported.");var r=document.createEvent(i);switch(i){case"MouseEvents":r.initMouseEvent(t,n.bubbles||!1,n.cancelable||!0,window,n.clickCount||1,0,0,n.x||n.clientX||0,n.y||n.clientY||0,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":i=r.initKeyboardEvent||r.initKeyEvent,a.defaults(n,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),i(t,n.bubbles||!1,n.cancelable,window,n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,n.keyCode,n.charCode);break;default:r.initEvent(t,n.bubbles||!1,n.cancelable||!0)}a.defaults(r,o),e.dispatchEvent(r)},bind:function(e,t,n,o){return e.addEventListener?e.addEventListener(t,n,o||!1):e.attachEvent&&e.attachEvent("on"+t,n),i},unbind:function(e,t,n,o){return e.removeEventListener?e.removeEventListener(t,n,o||!1):e.detachEvent&&e.detachEvent("on"+t,n),i},addClass:function(e,t){if(void 0===e.className)e.className=t;else if(e.className!==t){var n=e.className.split(/ +/);-1==n.indexOf(t)&&(n.push(t),e.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return i},removeClass:function(e,t){if(t){if(void 0!==e.className)if(e.className===t)e.removeAttribute("class");else{var n=e.className.split(/ +/),o=n.indexOf(t);-1!=o&&(n.splice(o,1),e.className=n.join(" "))}}else e.className=void 0;return i},hasClass:function(e,t){return RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){return t((e=getComputedStyle(e))["border-left-width"])+t(e["border-right-width"])+t(e["padding-left"])+t(e["padding-right"])+t(e.width)},getHeight:function(e){return t((e=getComputedStyle(e))["border-top-width"])+t(e["border-bottom-width"])+t(e["padding-top"])+t(e["padding-bottom"])+t(e.height)},getOffset:function(e){var t={left:0,top:0};if(e.offsetParent)for(;t.left+=e.offsetLeft,t.top+=e.offsetTop,e=e.offsetParent;);return t},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}};return i}(J.utils.common),J.controllers.OptionController=(a=J.controllers.Controller,s=J.dom.dom,l=J.utils.common,(d=function(e,t,n){d.superclass.call(this,e,t);var o=this;if(this.__select=document.createElement("select"),l.isArray(n)){var i={};l.each(n,function(e){i[e]=e}),n=i}l.each(n,function(e,t){var n=document.createElement("option");n.innerHTML=t,n.setAttribute("value",e),o.__select.appendChild(n)}),this.updateDisplay(),s.bind(this.__select,"change",function(){o.setValue(this.options[this.selectedIndex].value)}),this.domElement.appendChild(this.__select)}).superclass=a,l.extend(d.prototype,a.prototype,{setValue:function(e){return e=d.superclass.prototype.setValue.call(this,e),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),e},updateDisplay:function(){return this.__select.value=this.getValue(),d.superclass.prototype.updateDisplay.call(this)}}),d),J.controllers.NumberController=(c=J.controllers.Controller,u=J.utils.common,(h=function(e,t,n){h.superclass.call(this,e,t),n=n||{},this.__min=n.min,this.__max=n.max,this.__step=n.step,u.isUndefined(this.__step)?this.__impliedStep=0==this.initialValue?1:Math.pow(10,Math.floor(Math.log(this.initialValue)/Math.LN10))/10:this.__impliedStep=this.__step,e=-1<(e=(e=this.__impliedStep).toString()).indexOf(".")?e.length-e.indexOf(".")-1:0,this.__precision=e}).superclass=c,u.extend(h.prototype,c.prototype,{setValue:function(e){return void 0!==this.__min&&e<this.__min?e=this.__min:void 0!==this.__max&&e>this.__max&&(e=this.__max),void 0!==this.__step&&0!=e%this.__step&&(e=Math.round(e/this.__step)*this.__step),h.superclass.prototype.setValue.call(this,e)},min:function(e){return this.__min=e,this},max:function(e){return this.__max=e,this},step:function(e){return this.__step=e,this}}),h),J.controllers.NumberControllerBox=(f=J.controllers.NumberController,p=J.dom.dom,_=J.utils.common,(m=function(e,t,n){function o(){var e=parseFloat(s.__input.value);_.isNaN(e)||s.setValue(e)}function i(e){var t=a-e.clientY;s.setValue(s.getValue()+t*s.__impliedStep),a=e.clientY}function r(){p.unbind(window,"mousemove",i),p.unbind(window,"mouseup",r)}this.__truncationSuspended=!1,m.superclass.call(this,e,t,n);var a,s=this;this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),p.bind(this.__input,"change",o),p.bind(this.__input,"blur",function(){o(),s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}),p.bind(this.__input,"mousedown",function(e){p.bind(window,"mousemove",i),p.bind(window,"mouseup",r),a=e.clientY}),p.bind(this.__input,"keydown",function(e){13===e.keyCode&&(s.__truncationSuspended=!0,this.blur(),s.__truncationSuspended=!1)}),this.updateDisplay(),this.domElement.appendChild(this.__input)}).superclass=f,_.extend(m.prototype,f.prototype,{updateDisplay:function(){var e,t=this.__input;if(this.__truncationSuspended)e=this.getValue();else{e=this.getValue();var n=Math.pow(10,this.__precision);e=Math.round(e*n)/n}return t.value=e,m.superclass.prototype.updateDisplay.call(this)}}),m),J.controllers.NumberControllerSlider=(g=J.controllers.NumberController,y=J.dom.dom,v=J.utils.css,b=J.utils.common,(x=function(e,t,n,o,i){function r(e){e.preventDefault();var t,n,o,i,r,a=y.getOffset(l.__background),s=y.getWidth(l.__background);return l.setValue((t=e.clientX,n=a.left,o=a.left+s,i=l.__min,r=l.__max,i+(t-n)/(o-n)*(r-i))),!1}function a(){y.unbind(window,"mousemove",r),y.unbind(window,"mouseup",a),l.__onFinishChange&&l.__onFinishChange.call(l,l.getValue())}x.superclass.call(this,e,t,{min:n,max:o,step:i});var l=this;this.__background=document.createElement("div"),this.__foreground=document.createElement("div"),y.bind(this.__background,"mousedown",function(e){y.bind(window,"mousemove",r),y.bind(window,"mouseup",a),r(e)}),y.addClass(this.__background,"slider"),y.addClass(this.__foreground,"slider-fg"),this.updateDisplay(),this.__background.appendChild(this.__foreground),this.domElement.appendChild(this.__background)}).superclass=g,x.useDefaultStyles=function(){v.inject("/**\n * dat-gui JavaScript Controller Library\n * http://code.google.com/p/dat-gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\n\n.slider {\n  box-shadow: inset 0 2px 4px rgba(0,0,0,0.15);\n  height: 1em;\n  border-radius: 1em;\n  background-color: #eee;\n  padding: 0 0.5em;\n  overflow: hidden;\n}\n\n.slider-fg {\n  padding: 1px 0 2px 0;\n  background-color: #aaa;\n  height: 1em;\n  margin-left: -0.5em;\n  padding-right: 0.5em;\n  border-radius: 1em 0 0 1em;\n}\n\n.slider-fg:after {\n  display: inline-block;\n  border-radius: 1em;\n  background-color: #fff;\n  border:  1px solid #aaa;\n  content: '';\n  float: right;\n  margin-right: -1em;\n  margin-top: -1px;\n  height: 0.9em;\n  width: 0.9em;\n}")},b.extend(x.prototype,g.prototype,{updateDisplay:function(){var e=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*e+"%",x.superclass.prototype.updateDisplay.call(this)}}),x),J.controllers.FunctionController=(w=J.controllers.Controller,S=J.dom.dom,C=J.utils.common,(E=function(e,t,n){E.superclass.call(this,e,t);var o=this;this.__button=document.createElement("div"),this.__button.innerHTML=void 0===n?"Fire":n,S.bind(this.__button,"click",function(e){return e.preventDefault(),o.fire(),!1}),S.addClass(this.__button,"button"),this.domElement.appendChild(this.__button)}).superclass=w,C.extend(E.prototype,w.prototype,{fire:function(){this.__onChange&&this.__onChange.call(this),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.getValue().call(this.object)}}),E),J.controllers.BooleanController=(T=J.controllers.Controller,k=J.dom.dom,A=J.utils.common,(M=function(e,t){M.superclass.call(this,e,t);var n=this;this.__prev=this.getValue(),this.__checkbox=document.createElement("input"),this.__checkbox.setAttribute("type","checkbox"),k.bind(this.__checkbox,"change",function(){n.setValue(!n.__prev)},!1),this.domElement.appendChild(this.__checkbox),this.updateDisplay()}).superclass=T,A.extend(M.prototype,T.prototype,{setValue:function(e){return e=M.superclass.prototype.setValue.call(this,e),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),e},updateDisplay:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0):this.__checkbox.checked=!1,M.superclass.prototype.updateDisplay.call(this)}}),M),J.color.toString=(B=J.utils.common,function(e){if(1==e.a||B.isUndefined(e.a)){for(e=e.hex.toString(16);e.length<6;)e="0"+e;return"#"+e}return"rgba("+Math.round(e.r)+","+Math.round(e.g)+","+Math.round(e.b)+","+e.a+")"}),J.color.interpret=(D=J.color.toString,L=J.utils.common,F=[{litmus:L.isString,conversions:{THREE_CHAR_HEX:{read:function(e){return null!==(e=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i))&&{space:"HEX",hex:parseInt("0x"+e[1].toString()+e[1].toString()+e[2].toString()+e[2].toString()+e[3].toString()+e[3].toString())}},write:D},SIX_CHAR_HEX:{read:function(e){return null!==(e=e.match(/^#([A-F0-9]{6})$/i))&&{space:"HEX",hex:parseInt("0x"+e[1].toString())}},write:D},CSS_RGB:{read:function(e){return null!==(e=e.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/))&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3])}},write:D},CSS_RGBA:{read:function(e){return null!==(e=e.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/))&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3]),a:parseFloat(e[4])}},write:D}}},{litmus:L.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:L.isArray,conversions:{RGB_ARRAY:{read:function(e){return 3==e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return 4==e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:L.isObject,conversions:{RGBA_OBJ:{read:function(e){return!!(L.isNumber(e.r)&&L.isNumber(e.g)&&L.isNumber(e.b)&&L.isNumber(e.a))&&{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return!!(L.isNumber(e.r)&&L.isNumber(e.g)&&L.isNumber(e.b))&&{space:"RGB",r:e.r,g:e.g,b:e.b}},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return!!(L.isNumber(e.h)&&L.isNumber(e.s)&&L.isNumber(e.v)&&L.isNumber(e.a))&&{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return!!(L.isNumber(e.h)&&L.isNumber(e.s)&&L.isNumber(e.v))&&{space:"HSV",h:e.h,s:e.s,v:e.v}},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],function(){O=!1;var n=1<arguments.length?L.toArray(arguments):arguments[0];return L.each(F,function(e){if(e.litmus(n))return L.each(e.conversions,function(e,t){if(P=e.read(n),!1===O&&!1!==P)return(O=P).conversionName=t,P.conversion=e,L.BREAK}),L.BREAK}),O}),J.GUI=J.gui.GUI=function(e,t,n,r,a,s,l,d,c,o,u,i,h,f,p){function _(e,t,n,o){if(void 0===t[n])throw Error("Object "+t+' has no property "'+n+'"');t=o.color?new u(t,n):(t=[t,n].concat(o.factoryArgs),r.apply(e,t)),o.before instanceof a&&(o.before=o.before.__li),g(e,t),f.addClass(t.domElement,"c"),n=document.createElement("span"),f.addClass(n,"property-name"),n.innerHTML=t.property;var i=document.createElement("div");return i.appendChild(n),i.appendChild(t.domElement),o=m(e,i,o.before),f.addClass(o,M.CLASS_CONTROLLER_ROW),f.addClass(o,typeof t.getValue()),function(t,n,o){if(o.__li=n,o.__gui=t,p.extend(o,{options:function(e){return 1<arguments.length?(o.remove(),_(t,o.object,o.property,{before:o.__li.nextElementSibling,factoryArgs:[p.toArray(arguments)]})):p.isArray(e)||p.isObject(e)?(o.remove(),_(t,o.object,o.property,{before:o.__li.nextElementSibling,factoryArgs:[e]})):void 0},name:function(e){return o.__li.firstElementChild.firstElementChild.innerHTML=e,o},listen:function(){return o.__gui.listen(o),o},remove:function(){return o.__gui.remove(o),o}}),o instanceof c){var i=new d(o.object,o.property,{min:o.__min,max:o.__max,step:o.__step});p.each(["updateDisplay","onChange","onFinishChange"],function(e){var t=o[e],n=i[e];o[e]=i[e]=function(){var e=Array.prototype.slice.call(arguments);return t.apply(o,e),n.apply(i,e)}}),f.addClass(n,"has-slider"),o.domElement.insertBefore(i.domElement,o.domElement.firstElementChild)}else if(o instanceof d){var e=function(e){return p.isNumber(o.__min)&&p.isNumber(o.__max)?(o.remove(),_(t,o.object,o.property,{before:o.__li.nextElementSibling,factoryArgs:[o.__min,o.__max,o.__step]})):e};o.min=p.compose(e,o.min),o.max=p.compose(e,o.max)}else o instanceof s?(f.bind(n,"click",function(){f.fakeEvent(o.__checkbox,"click")}),f.bind(o.__checkbox,"click",function(e){e.stopPropagation()})):o instanceof l?(f.bind(n,"click",function(){f.fakeEvent(o.__button,"click")}),f.bind(n,"mouseover",function(){f.addClass(o.__button,"hover")}),f.bind(n,"mouseout",function(){f.removeClass(o.__button,"hover")})):o instanceof u&&(f.addClass(n,"color"),o.updateDisplay=p.compose(function(e){return n.style.borderLeftColor=o.__color.toString(),e},o.updateDisplay),o.updateDisplay());o.setValue=p.compose(function(e){return t.getRoot().__preset_select&&o.isModified()&&x(t.getRoot(),!0),e},o.setValue)}(e,o,t),e.__controllers.push(t),t}function m(e,t,n){var o=document.createElement("li");return t&&o.appendChild(t),n?e.__ul.insertBefore(o,params.before):e.__ul.appendChild(o),e.onResize(),o}function g(e,t){var n=e.getRoot(),o=n.__rememberedObjects.indexOf(t.object);if(-1!=o){var i=n.__rememberedObjectIndecesToControllers[o];if(void 0===i&&(i={},n.__rememberedObjectIndecesToControllers[o]=i),i[t.property]=t,n.load&&n.load.remembered){if((n=n.load.remembered)[e.preset])n=n[e.preset];else{if(!n[S])return;n=n[S]}n[o]&&void 0!==n[o][t.property]&&(o=n[o][t.property],t.initialValue=o,t.setValue(o))}}}function y(e,t){e.domElement.style.width=t+"px",e.__save_row&&e.autoPlace&&(e.__save_row.style.width=t+"px"),e.__closeButton&&(e.__closeButton.style.width=t+"px")}function v(o,i){var r={};return p.each(o.__rememberedObjects,function(e,t){var n={};p.each(o.__rememberedObjectIndecesToControllers[t],function(e,t){n[t]=i?e.initialValue:e.getValue()}),r[t]=n}),r}function b(e,t,n){var o=document.createElement("option");o.innerHTML=t,o.value=t,e.__preset_select.appendChild(o),n&&(e.__preset_select.selectedIndex=e.__preset_select.length-1)}function x(e,t){var n=e.__preset_select[e.__preset_select.selectedIndex];n.innerHTML=t?n.value+"*":n.value}e.inject(".dg {\n  /** Clear list styles */\n  /* Auto-place container */\n  /* Auto-placed GUI's */\n  /* Line items that don't contain folders. */\n  /** Folder names */\n  /** Hides closed items */\n  /** Controller row */\n  /** Name-half (left) */\n  /** Controller-half (right) */\n  /** Controller placement */\n  /** Shorter number boxes when slider is present. */\n  /** Ensure the entire boolean and function row shows a hand */ }\n  .dg ul {\n    list-style: none;\n    margin: 0;\n    padding: 0;\n    width: 100%;\n    clear: both; }\n  .dg.ac {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    height: 0;\n    z-index: 0; }\n  .dg:not(.ac) .main {\n    /** Exclude mains in ac so that we don't hide close button */\n    overflow: hidden; }\n  .dg.main {\n    -webkit-transition: opacity 0.1s linear;\n    -o-transition: opacity 0.1s linear;\n    -moz-transition: opacity 0.1s linear;\n    transition: opacity 0.1s linear; }\n    .dg.main.taller-than-window {\n      overflow-y: auto; }\n      .dg.main.taller-than-window .close-button {\n        opacity: 1;\n        /* TODO, these are style notes */\n        margin-top: -1px;\n        border-top: 1px solid #2c2c2c; }\n    .dg.main ul.closed .close-button {\n      opacity: 1 !important; }\n    .dg.main:hover .close-button,\n    .dg.main .close-button.drag {\n      opacity: 1; }\n    .dg.main .close-button {\n      /*opacity: 0;*/\n      -webkit-transition: opacity 0.1s linear;\n      -o-transition: opacity 0.1s linear;\n      -moz-transition: opacity 0.1s linear;\n      transition: opacity 0.1s linear;\n      border: 0;\n      position: absolute;\n      line-height: 19px;\n      height: 20px;\n      /* TODO, these are style notes */\n      cursor: pointer;\n      text-align: center;\n      background-color: #000; }\n      .dg.main .close-button:hover {\n        background-color: #111; }\n  .dg.a {\n    float: right;\n    margin-right: 15px;\n    overflow-x: hidden; }\n    .dg.a.has-save > ul {\n      margin-top: 27px; }\n      .dg.a.has-save > ul.closed {\n        margin-top: 0; }\n    .dg.a .save-row {\n      position: fixed;\n      top: 0;\n      z-index: 1002; }\n  .dg li {\n    -webkit-transition: height 0.1s ease-out;\n    -o-transition: height 0.1s ease-out;\n    -moz-transition: height 0.1s ease-out;\n    transition: height 0.1s ease-out; }\n  .dg li:not(.folder) {\n    cursor: auto;\n    height: 27px;\n    line-height: 27px;\n    overflow: hidden;\n    padding: 0 4px 0 5px; }\n  .dg li.folder {\n    padding: 0;\n    border-left: 4px solid rgba(0, 0, 0, 0); }\n  .dg li.title {\n    cursor: pointer;\n    margin-left: -4px; }\n  .dg .closed li:not(.title),\n  .dg .closed ul li,\n  .dg .closed ul li > * {\n    height: 0;\n    overflow: hidden;\n    border: 0; }\n  .dg .cr {\n    clear: both;\n    padding-left: 3px;\n    height: 27px; }\n  .dg .property-name {\n    cursor: default;\n    float: left;\n    clear: left;\n    width: 40%;\n    overflow: hidden;\n    text-overflow: ellipsis; }\n  .dg .c {\n    float: left;\n    width: 60%; }\n  .dg .c input[type=text] {\n    border: 0;\n    margin-top: 4px;\n    padding: 3px;\n    width: 100%;\n    float: right; }\n  .dg .has-slider input[type=text] {\n    width: 30%;\n    /*display: none;*/\n    margin-left: 0; }\n  .dg .slider {\n    float: left;\n    width: 66%;\n    margin-left: -5px;\n    margin-right: 0;\n    height: 19px;\n    margin-top: 4px; }\n  .dg .slider-fg {\n    height: 100%; }\n  .dg .c input[type=checkbox] {\n    margin-top: 9px; }\n  .dg .c select {\n    margin-top: 5px; }\n  .dg .cr.function,\n  .dg .cr.function .property-name,\n  .dg .cr.function *,\n  .dg .cr.boolean,\n  .dg .cr.boolean * {\n    cursor: pointer; }\n  .dg .selector {\n    display: none;\n    position: absolute;\n    margin-left: -9px;\n    margin-top: 23px;\n    z-index: 10; }\n  .dg .c:hover .selector,\n  .dg .selector.drag {\n    display: block; }\n  .dg li.save-row {\n    padding: 0; }\n    .dg li.save-row .button {\n      display: inline-block;\n      padding: 0px 6px; }\n  .dg.dialogue {\n    background-color: #222;\n    width: 460px;\n    padding: 15px;\n    font-size: 13px;\n    line-height: 15px; }\n\n/* TODO Separate style and structure */\n#dg-new-constructor {\n  padding: 10px;\n  color: #222;\n  font-family: Monaco, monospace;\n  font-size: 10px;\n  border: 0;\n  resize: none;\n  box-shadow: inset 1px 1px 1px #888;\n  word-wrap: break-word;\n  margin: 12px 0;\n  display: block;\n  width: 440px;\n  overflow-y: scroll;\n  height: 100px;\n  position: relative; }\n\n#dg-local-explain {\n  display: none;\n  font-size: 11px;\n  line-height: 17px;\n  border-radius: 3px;\n  background-color: #333;\n  padding: 8px;\n  margin-top: 10px; }\n  #dg-local-explain code {\n    font-size: 10px; }\n\n#dat-gui-save-locally {\n  display: none; }\n\n/** Main type */\n.dg {\n  color: #eee;\n  font: 11px 'Lucida Grande', sans-serif;\n  text-shadow: 0 -1px 0 #111;\n  /** Auto place */\n  /* Controller row, <li> */\n  /** Controllers */ }\n  .dg.main {\n    /** Scrollbar */ }\n    .dg.main::-webkit-scrollbar {\n      width: 5px;\n      background: #1a1a1a; }\n    .dg.main::-webkit-scrollbar-corner {\n      height: 0;\n      display: none; }\n    .dg.main::-webkit-scrollbar-thumb {\n      border-radius: 5px;\n      background: #676767; }\n  .dg li:not(.folder) {\n    background: #1a1a1a;\n    border-bottom: 1px solid #2c2c2c; }\n  .dg li.save-row {\n    line-height: 25px;\n    background: #dad5cb;\n    border: 0; }\n    .dg li.save-row select {\n      margin-left: 5px;\n      width: 108px; }\n    .dg li.save-row .button {\n      margin-left: 5px;\n      margin-top: 1px;\n      border-radius: 2px;\n      font-size: 9px;\n      line-height: 7px;\n      padding: 4px 4px 5px 4px;\n      background: #c5bdad;\n      color: #fff;\n      text-shadow: 0 1px 0 #b0a58f;\n      box-shadow: 0 -1px 0 #b0a58f;\n      cursor: pointer; }\n      .dg li.save-row .button.gears {\n        background: #c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;\n        height: 7px;\n        width: 8px; }\n      .dg li.save-row .button:hover {\n        background-color: #bab19e;\n        box-shadow: 0 -1px 0 #b0a58f; }\n  .dg li.folder {\n    border-bottom: 0; }\n  .dg li.title {\n    padding-left: 16px;\n    background: black url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;\n    cursor: pointer;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.2); }\n  .dg .closed li.title {\n    background-image: url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==); }\n  .dg .cr.boolean {\n    border-left: 3px solid #806787; }\n  .dg .cr.function {\n    border-left: 3px solid #e61d5f; }\n  .dg .cr.number {\n    border-left: 3px solid #2fa1d6; }\n    .dg .cr.number input[type=text] {\n      color: #2fa1d6; }\n  .dg .cr.string {\n    border-left: 3px solid #1ed36f; }\n    .dg .cr.string input[type=text] {\n      color: #1ed36f; }\n  .dg .cr.function:hover, .dg .cr.boolean:hover {\n    background: #111; }\n  .dg .c input[type=text] {\n    background: #303030;\n    outline: none; }\n    .dg .c input[type=text]:hover {\n      background: #3c3c3c; }\n    .dg .c input[type=text]:focus {\n      background: #494949;\n      color: #fff; }\n  .dg .c .slider {\n    background: #303030;\n    cursor: ew-resize; }\n  .dg .c .slider-fg {\n    background: #2fa1d6; }\n  .dg .c .slider:hover {\n    background: #3c3c3c; }\n    .dg .c .slider:hover .slider-fg {\n      background: #44abda; }\n");var w,S="Default";try{w="localStorage"in window&&null!==window.localStorage}catch(e){w=!1}var C,E,T=!0,k=!1,A=[],M=function(t){function n(){localStorage.setItem(document.location.href+".gui",JSON.stringify(o.getSaveObject()))}var o=this;this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),f.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],t=t||{},t=p.defaults(t,{autoPlace:!0,width:M.DEFAULT_WIDTH}),t=p.defaults(t,{resizable:t.autoPlace,hideable:t.autoPlace}),p.isUndefined(t.load)?t.load={preset:S}:t.preset&&(t.load.preset=t.preset),p.isUndefined(t.parent)&&t.hideable&&A.push(this),t.resizable=p.isUndefined(t.parent)&&t.resizable,t.autoPlace&&p.isUndefined(t.scrollable)&&(t.scrollable=!0);var e,i=w&&"true"===localStorage.getItem(document.location.href+".isLocal");if(Object.defineProperties(this,{parent:{get:function(){return t.parent}},scrollable:{get:function(){return t.scrollable}},autoPlace:{get:function(){return t.autoPlace}},preset:{get:function(){return o.parent?o.getRoot().preset:t.load.preset},set:function(e){for(o.parent?o.getRoot().preset=e:t.load.preset=e,e=0;e<this.__preset_select.length;e++)this.__preset_select[e].value==this.preset&&(this.__preset_select.selectedIndex=e);o.revert()}},width:{get:function(){return t.width},set:function(e){t.width=e,y(o,e)}},name:{get:function(){return t.name},set:function(e){t.name=e,a&&(a.innerHTML=t.name)}},closed:{get:function(){return t.closed},set:function(e){t.closed=e,t.closed?f.addClass(o.__ul,M.CLASS_CLOSED):f.removeClass(o.__ul,M.CLASS_CLOSED),this.onResize(),o.__closeButton&&(o.__closeButton.innerHTML=e?M.TEXT_OPEN:M.TEXT_CLOSED)}},load:{get:function(){return t.load}},useLocalStorage:{get:function(){return i},set:function(e){w&&((i=e)?f.bind(window,"unload",n):f.unbind(window,"unload",n),localStorage.setItem(document.location.href+".isLocal",e))}}}),p.isUndefined(t.parent)){if(t.closed=!1,f.addClass(this.domElement,M.CLASS_MAIN),f.makeSelectable(this.domElement,!1),w&&i){o.useLocalStorage=!0;var r=localStorage.getItem(document.location.href+".gui");r&&(t.load=JSON.parse(r))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=M.TEXT_CLOSED,f.addClass(this.__closeButton,M.CLASS_CLOSE_BUTTON),this.domElement.appendChild(this.__closeButton),f.bind(this.__closeButton,"click",function(){o.closed=!o.closed})}else{void 0===t.closed&&(t.closed=!0);var a=document.createTextNode(t.name);f.addClass(a,"controller-name"),r=m(o,a),f.addClass(this.__ul,M.CLASS_CLOSED),f.addClass(r,"title"),f.bind(r,"click",function(e){return e.preventDefault(),o.closed=!o.closed,!1}),t.closed||(this.closed=!1)}t.autoPlace&&(p.isUndefined(t.parent)&&(T&&(E=document.createElement("div"),f.addClass(E,"dg"),f.addClass(E,M.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(E),T=!1),E.appendChild(this.domElement),f.addClass(this.domElement,M.CLASS_AUTO_PLACE)),this.parent||y(o,t.width)),f.bind(window,"resize",function(){o.onResize()}),f.bind(this.__ul,"webkitTransitionEnd",function(){o.onResize()}),f.bind(this.__ul,"transitionend",function(){o.onResize()}),f.bind(this.__ul,"oTransitionEnd",function(){o.onResize()}),this.onResize(),t.resizable&&function(t){function e(e){return e.preventDefault(),i=e.clientX,f.addClass(t.__closeButton,M.CLASS_DRAG),f.bind(window,"mousemove",n),f.bind(window,"mouseup",o),!1}function n(e){return e.preventDefault(),t.width+=i-e.clientX,t.onResize(),i=e.clientX,!1}function o(){f.removeClass(t.__closeButton,M.CLASS_DRAG),f.unbind(window,"mousemove",n),f.unbind(window,"mouseup",o)}var i;t.__resize_handle=document.createElement("div"),p.extend(t.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),f.bind(t.__resize_handle,"mousedown",e),f.bind(t.__closeButton,"mousedown",e),t.domElement.insertBefore(t.__resize_handle,t.domElement.firstElementChild)}(this),o.getRoot(),t.parent||((e=o.getRoot()).width+=1,p.defer(function(){e.width-=1}))};return M.toggleHide=function(){k=!k,p.each(A,function(e){e.domElement.style.zIndex=k?-999:999,e.domElement.style.opacity=k?0:1})},M.CLASS_AUTO_PLACE="a",M.CLASS_AUTO_PLACE_CONTAINER="ac",M.CLASS_MAIN="main",M.CLASS_CONTROLLER_ROW="cr",M.CLASS_TOO_TALL="taller-than-window",M.CLASS_CLOSED="closed",M.CLASS_CLOSE_BUTTON="close-button",M.CLASS_DRAG="drag",M.DEFAULT_WIDTH=245,M.TEXT_CLOSED="Close Controls",M.TEXT_OPEN="Open Controls",f.bind(window,"keydown",function(e){"text"===document.activeElement.type||72!==e.which&&72!=e.keyCode||M.toggleHide()},!1),p.extend(M.prototype,{add:function(e,t){return _(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return _(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.slice(this.__controllers.indexOf(e),1);var t=this;p.defer(function(){t.onResize()})},destroy:function(){this.autoPlace&&E.removeChild(this.domElement)},addFolder:function(e){if(void 0!==this.__folders[e])throw Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};return t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]),t=new M(t),this.__folders[e]=t,e=m(this,t.domElement),f.addClass(e,"folder"),t},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){var t=this.getRoot();if(t.scrollable){var e=f.getOffset(t.__ul).top,n=0;p.each(t.__ul.childNodes,function(e){t.autoPlace&&e===t.__save_row||(n+=f.getHeight(e))}),window.innerHeight-e-20<n?(f.addClass(t.domElement,M.CLASS_TOO_TALL),t.__ul.style.height=window.innerHeight-e-20+"px"):(f.removeClass(t.domElement,M.CLASS_TOO_TALL),t.__ul.style.height="auto")}t.__resize_handle&&p.defer(function(){t.__resize_handle.style.height=t.__ul.offsetHeight+"px"}),t.__closeButton&&(t.__closeButton.style.width=t.width+"px")},remember:function(){if(p.isUndefined(C)&&((C=new h).domElement.innerHTML='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n      \n    </div>\n    \n  </div>\n\n</div>'),this.parent)throw Error("You can only call remember on a top level GUI.");var t=this;p.each(Array.prototype.slice.call(arguments),function(e){0==t.__rememberedObjects.length&&function(n){var e=n.__save_row=document.createElement("li");f.addClass(n.domElement,"has-save"),n.__ul.insertBefore(e,n.__ul.firstChild),f.addClass(e,"save-row");var t=document.createElement("span");t.innerHTML="&nbsp;",f.addClass(t,"button gears");var o=document.createElement("span");o.innerHTML="Save",f.addClass(o,"button"),f.addClass(o,"save");var i=document.createElement("span");i.innerHTML="New",f.addClass(i,"button"),f.addClass(i,"save-as");var r=document.createElement("span");r.innerHTML="Revert",f.addClass(r,"button"),f.addClass(r,"revert");var a=n.__preset_select=document.createElement("select");if(n.load&&n.load.remembered?p.each(n.load.remembered,function(e,t){b(n,t,t==n.preset)}):b(n,S,!1),f.bind(a,"change",function(){for(var e=0;e<n.__preset_select.length;e++)n.__preset_select[e].innerHTML=n.__preset_select[e].value;n.preset=this.value}),e.appendChild(a),e.appendChild(t),e.appendChild(o),e.appendChild(i),e.appendChild(r),w){e=document.getElementById("dg-save-locally");var s=document.getElementById("dg-local-explain");e.style.display="block",e=document.getElementById("dg-local-storage"),"true"===localStorage.getItem(document.location.href+".isLocal")&&e.setAttribute("checked","checked");var l=function(){s.style.display=n.useLocalStorage?"block":"none"};l(),f.bind(e,"change",function(){n.useLocalStorage=!n.useLocalStorage,l()})}var d=document.getElementById("dg-new-constructor");f.bind(d,"keydown",function(e){!e.metaKey||67!==e.which&&67!=e.keyCode||C.hide()}),f.bind(t,"click",function(){d.innerHTML=JSON.stringify(n.getSaveObject(),void 0,2),C.show(),d.focus(),d.select()}),f.bind(o,"click",function(){n.save()}),f.bind(i,"click",function(){var e=prompt("Enter a new preset name.");e&&n.saveAs(e)}),f.bind(r,"click",function(){n.revert()})}(t),-1==t.__rememberedObjects.indexOf(e)&&t.__rememberedObjects.push(e)}),this.autoPlace&&y(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var n=this.load;return n.closed=this.closed,0<this.__rememberedObjects.length&&(n.preset=this.preset,n.remembered||(n.remembered={}),n.remembered[this.preset]=v(this)),n.folders={},p.each(this.__folders,function(e,t){n.folders[t]=e.getSaveObject()}),n},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=v(this),x(this,!1)},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[S]=v(this,!0)),this.load.remembered[e]=v(this),this.preset=e,b(this,e,!0)},revert:function(t){p.each(this.__controllers,function(e){this.getRoot().load.remembered?g(t||this.getRoot(),e):e.setValue(e.initialValue)},this),p.each(this.__folders,function(e){e.revert(e)}),t||x(this.getRoot(),!1)},listen:function(e){var t=0==this.__listening.length;this.__listening.push(e),t&&function e(t){0!=t.length&&i(function(){e(t)}),p.each(t,function(e){e.updateDisplay()})}(this.__listening)}}),M}(J.utils.css,0,0,J.controllers.factory=(W=J.controllers.OptionController,V=J.controllers.NumberControllerBox,G=J.controllers.NumberControllerSlider,z=J.controllers.StringController=(Y=J.controllers.Controller,q=J.dom.dom,K=J.utils.common,(Q=function(e,t){function n(){o.setValue(o.__input.value)}Q.superclass.call(this,e,t);var o=this;this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),q.bind(this.__input,"keyup",n),q.bind(this.__input,"change",n),q.bind(this.__input,"blur",function(){o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())}),q.bind(this.__input,"keydown",function(e){13===e.keyCode&&this.blur()}),this.updateDisplay(),this.domElement.appendChild(this.__input)}).superclass=Y,K.extend(Q.prototype,Y.prototype,{updateDisplay:function(){return q.isActive(this.__input)||(this.__input.value=this.getValue()),Q.superclass.prototype.updateDisplay.call(this)}}),Q),U=J.controllers.FunctionController,j=J.controllers.BooleanController,X=J.utils.common,function(e,t,n,o){var i=e[t];return X.isArray(n)||X.isObject(n)?new W(e,t,n):X.isNumber(i)?X.isNumber(n)&&X.isNumber(o)?new G(e,t,n,o):new V(e,t,{min:n,max:o}):X.isString(i)?new z(e,t):X.isFunction(i)?new U(e,t,""):X.isBoolean(i)?new j(e,t):void 0}),J.controllers.Controller,J.controllers.BooleanController,J.controllers.FunctionController,J.controllers.NumberControllerBox,J.controllers.NumberControllerSlider,J.controllers.OptionController,J.controllers.ColorController=function(e,u,h,f,p){function _(t,n,o,i){t.style.background="",p.each(r,function(e){t.style.cssText+="background: "+e+"linear-gradient("+n+", "+o+" 0%, "+i+" 100%); "})}var m=function(e,t){function n(e){a(e),u.bind(window,"mousemove",a),u.bind(window,"mouseup",o)}function o(){u.unbind(window,"mousemove",a),u.unbind(window,"mouseup",o)}function i(){var e=f(this.value);!1!==e?(l.__color.__state=e,l.setValue(l.__color.toOriginal())):this.value=l.__color.toString()}function r(){u.unbind(window,"mousemove",s),u.unbind(window,"mouseup",r)}function a(e){e.preventDefault();var t=u.getWidth(l.__saturation_field),n=u.getOffset(l.__saturation_field),o=(e.clientX-n.left+document.body.scrollLeft)/t;return 1<(e=1-(e.clientY-n.top+document.body.scrollTop)/t)?e=1:e<0&&(e=0),1<o?o=1:o<0&&(o=0),l.__color.v=e,l.__color.s=o,l.setValue(l.__color.toOriginal()),!1}function s(e){e.preventDefault();var t=u.getHeight(l.__hue_field),n=u.getOffset(l.__hue_field);return 1<(e=1-(e.clientY-n.top+document.body.scrollTop)/t)?e=1:e<0&&(e=0),l.__color.h=360*e,l.setValue(l.__color.toOriginal()),!1}m.superclass.call(this,e,t),this.__color=new h(this.getValue()),this.__temp=new h(0);var l=this;this.domElement=document.createElement("div"),u.makeSelectable(this.domElement,!1),this.__selector=document.createElement("div"),this.__selector.className="selector",this.__saturation_field=document.createElement("div"),this.__saturation_field.className="saturation-field",this.__field_knob=document.createElement("div"),this.__field_knob.className="field-knob",this.__field_knob_border="2px solid ",this.__hue_knob=document.createElement("div"),this.__hue_knob.className="hue-knob",this.__hue_field=document.createElement("div"),this.__hue_field.className="hue-field",this.__input=document.createElement("input"),this.__input.type="text",this.__input_textShadow="0 1px 1px ",u.bind(this.__input,"keydown",function(e){13===e.keyCode&&i.call(this)}),u.bind(this.__input,"blur",i),u.bind(this.__selector,"mousedown",function(e){u.addClass(this,"drag").bind(window,"mouseup",function(e){u.removeClass(l.__selector,"drag")})});var d,c=document.createElement("div");p.extend(this.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),p.extend(this.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:this.__field_knob_border+(this.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),p.extend(this.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),p.extend(this.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),p.extend(c.style,{width:"100%",height:"100%",background:"none"}),_(c,"top","rgba(0,0,0,0)","#000"),p.extend(this.__hue_field.style,{width:"15px",height:"100px",display:"inline-block",border:"1px solid #555",cursor:"ns-resize"}),(d=this.__hue_field).style.background="",d.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",d.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",d.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",d.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",d.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",p.extend(this.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:this.__input_textShadow+"rgba(0,0,0,0.7)"}),u.bind(this.__saturation_field,"mousedown",n),u.bind(this.__field_knob,"mousedown",n),u.bind(this.__hue_field,"mousedown",function(e){s(e),u.bind(window,"mousemove",s),u.bind(window,"mouseup",r)}),this.__saturation_field.appendChild(c),this.__selector.appendChild(this.__field_knob),this.__selector.appendChild(this.__saturation_field),this.__selector.appendChild(this.__hue_field),this.__hue_field.appendChild(this.__hue_knob),this.domElement.appendChild(this.__input),this.domElement.appendChild(this.__selector),this.updateDisplay()};m.superclass=e,p.extend(m.prototype,e.prototype,{updateDisplay:function(){var t=f(this.getValue());if(!1!==t){var n=!1;p.each(h.COMPONENTS,function(e){if(!p.isUndefined(t[e])&&!p.isUndefined(this.__color.__state[e])&&t[e]!==this.__color.__state[e])return n=!0,{}},this),n&&p.extend(this.__color.__state,t)}p.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var e=this.__color.v<.5||.5<this.__color.s?255:0,o=255-e;p.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toString(),border:this.__field_knob_border+"rgb("+e+","+e+","+e+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,_(this.__saturation_field,"left","#fff",this.__temp.toString()),p.extend(this.__input.style,{backgroundColor:this.__input.value=this.__color.toString(),color:"rgb("+e+","+e+","+e+")",textShadow:this.__input_textShadow+"rgba("+o+","+o+","+o+",.7)"})}});var r=["-moz-","-o-","-webkit-","-ms-",""];return m}(J.controllers.Controller,J.dom.dom,J.color.Color=function(e,o,t,i){function n(e,t,n){Object.defineProperty(e,t,{get:function(){return"RGB"===this.__state.space||a(this,t,n),this.__state[t]},set:function(e){"RGB"!==this.__state.space&&(a(this,t,n),this.__state.space="RGB"),this.__state[t]=e}})}function r(e,t){Object.defineProperty(e,t,{get:function(){return"HSV"===this.__state.space||s(this),this.__state[t]},set:function(e){"HSV"!==this.__state.space&&(s(this),this.__state.space="HSV"),this.__state[t]=e}})}function a(e,t,n){if("HEX"===e.__state.space)e.__state[t]=o.component_from_hex(e.__state.hex,n);else{if("HSV"!==e.__state.space)throw"Corrupted color state";i.extend(e.__state,o.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v))}}function s(e){var t=o.rgb_to_hsv(e.r,e.g,e.b);i.extend(e.__state,{s:t.s,v:t.v}),i.isNaN(t.h)?i.isUndefined(e.__state.h)&&(e.__state.h=0):e.__state.h=t.h}var l=function(){if(this.__state=e.apply(this,arguments),!1===this.__state)throw"Failed to interpret color arguments";this.__state.a=this.__state.a||1};return l.COMPONENTS="r g b h s v hex a".split(" "),i.extend(l.prototype,{toString:function(){return t(this)},toOriginal:function(){return this.__state.conversion.write(this)}}),n(l.prototype,"r",2),n(l.prototype,"g",1),n(l.prototype,"b",0),r(l.prototype,"h"),r(l.prototype,"s"),r(l.prototype,"v"),Object.defineProperty(l.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}}),Object.defineProperty(l.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=o.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}}),l}(J.color.interpret,J.color.math={hsv_to_rgb:function(e,t,n){var o=e/60-Math.floor(e/60),i=n*(1-t),r=n*(1-o*t);return{r:255*(e=[[n,t=n*(1-(1-o)*t),i],[r,n,i],[i,n,t],[i,r,n],[t,i,n],[n,i,r]][Math.floor(e/60)%6])[0],g:255*e[1],b:255*e[2]}},rgb_to_hsv:function(e,t,n){var o=Math.min(e,t,n),i=Math.max(e,t,n);return o=i-o,0==i?{h:NaN,s:0,v:0}:((e=(e==i?(t-n)/o:t==i?2+(n-e)/o:4+(e-t)/o)/6)<0&&(e+=1),{h:360*e,s:o/i,v:i/255})},rgb_to_hex:function(e,t,n){return e=this.hex_with_component(0,2,e),e=this.hex_with_component(e,1,t),this.hex_with_component(e,0,n)},component_from_hex:function(e,t){return e>>8*t&255},hex_with_component:function(e,t,n){return n<<(N=8*t)|e&~(255<<N)}},J.color.toString,J.utils.common),J.color.interpret,J.utils.common),J.utils.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){window.setTimeout(e,1e3/60)},J.dom.CenteredDiv=(I=J.dom.dom,R=J.utils.common,(H=function(){this.backgroundElement=document.createElement("div"),R.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear"}),I.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),R.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var e=this;I.bind(this.backgroundElement,"click",function(){e.hide()})}).prototype.show=function(){var e=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),R.defer(function(){e.backgroundElement.style.opacity=1,e.domElement.style.opacity=1,e.domElement.style.webkitTransform="scale(1)"})},H.prototype.hide=function(){var e=this,t=function(){e.domElement.style.display="none",e.backgroundElement.style.display="none",I.unbind(e.domElement,"webkitTransitionEnd",t),I.unbind(e.domElement,"transitionend",t),I.unbind(e.domElement,"oTransitionEnd",t)};I.bind(this.domElement,"webkitTransitionEnd",t),I.bind(this.domElement,"transitionend",t),I.bind(this.domElement,"oTransitionEnd",t),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"},H.prototype.layout=function(){this.domElement.style.left=window.innerWidth/2-I.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-I.getHeight(this.domElement)/2+"px"},H),J.dom.dom,J.utils.common)},{}],22:[function(e,t,n){!function(){"use strict";var p=null,a=!0,r=!1;if(function(){try{"undefined"!=typeof AudioContext?p=new AudioContext:"undefined"!=typeof webkitAudioContext?p=new webkitAudioContext:a=!1}catch(e){a=!1}if(!a)if("undefined"!=typeof Audio)try{new Audio}catch(e){r=!0}else r=!0}(),a){var s=void 0===p.createGain?p.createGainNode():p.createGain();s.gain.value=1,s.connect(p.destination)}var e=function(){this.init()};e.prototype={init:function(){var e=this||_;return e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e.iOSAutoEnable=!0,e.noAudio=r,e.usingWebAudio=a,e.ctx=p,r||e._setupCodecs(),e},volume:function(e){var t=this||_;if(void 0!==(e=parseFloat(e))&&0<=e&&e<=1){t._volume=e,a&&(s.gain.value=e);for(var n=0;n<t._howls.length;n++)if(!t._howls[n]._webAudio)for(var o=t._howls[n]._getSoundIds(),i=0;i<o.length;i++){var r=t._howls[n]._soundById(o[i]);r&&r._node&&(r._node.volume=r._volume*e)}return t}return t._volume},mute:function(e){var t=this||_;t._muted=e,a&&(s.gain.value=e?0:t._volume);for(var n=0;n<t._howls.length;n++)if(!t._howls[n]._webAudio)for(var o=t._howls[n]._getSoundIds(),i=0;i<o.length;i++){var r=t._howls[n]._soundById(o[i]);r&&r._node&&(r._node.muted=!!e||r._muted)}return t},codecs:function(e){return(this||_)._codecs[e]},_setupCodecs:function(){var e=this||_,t=new Audio,n=t.canPlayType("audio/mpeg;").replace(/^no$/,""),o=/OPR\//.test(navigator.userAgent);return e._codecs={mp3:!(o||!n&&!t.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!n,opus:!!t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!t.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!t.canPlayType("audio/aac;").replace(/^no$/,""),m4a:!!(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(t.canPlayType("audio/x-mp4;")||t.canPlayType("audio/mp4;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")},e},_enableiOSAudio:function(){var n=this||_;if(!p||!n._iOSEnabled&&/iPhone|iPad|iPod/i.test(navigator.userAgent)){n._iOSEnabled=!1;var o=function(){var e=p.createBuffer(1,1,22050),t=p.createBufferSource();t.buffer=e,t.connect(p.destination),void 0===t.start?t.noteOn(0):t.start(0),setTimeout(function(){(t.playbackState===t.PLAYING_STATE||t.playbackState===t.FINISHED_STATE)&&(n._iOSEnabled=!0,n.iOSAutoEnable=!1,document.removeEventListener("touchend",o,!1))},0)};return document.addEventListener("touchend",o,!1),n}}};var _=new e,t=function(e){return e.src&&0!==e.src.length?void this.init(e):void console.error("An array of source files must be passed with any new Howl.")};t.prototype={init:function(e){var t=this;return t._autoplay=e.autoplay||!1,t._ext=e.ext||null,t._html5=e.html5||!1,t._muted=e.mute||!1,t._loop=e.loop||!1,t._pool=e.pool||5,t._preload="boolean"!=typeof e.preload||e.preload,t._rate=e.rate||1,t._sprite=e.sprite||{},t._src="string"!=typeof e.src?e.src:[e.src],t._volume=void 0!==e.volume?e.volume:1,t._duration=0,t._loaded=!1,t._sounds=[],t._endTimers={},t._onend=e.onend?[{fn:e.onend}]:[],t._onfaded=e.onfaded?[{fn:e.onfaded}]:[],t._onload=e.onload?[{fn:e.onload}]:[],t._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],t._onpause=e.onpause?[{fn:e.onpause}]:[],t._onplay=e.onplay?[{fn:e.onplay}]:[],t._onstop=e.onstop?[{fn:e.onstop}]:[],t._webAudio=a&&!t._html5,void 0!==p&&p&&_.iOSAutoEnable&&_._enableiOSAudio(),_._howls.push(t),t._preload&&t.load(),t},load:function(){var e=this,t=null;if(!r){"string"==typeof e._src&&(e._src=[e._src]);for(var n=0;n<e._src.length;n++){var o,i;if(e._ext&&e._ext[n]?o=e._ext[n]:(i=e._src[n],(o=/^data:audio\/([^;,]+);/i.exec(i))||(o=/\.([^.]+)$/.exec(i.split("?",1)[0])),o&&(o=o[1].toLowerCase())),_.codecs(o)){t=e._src[n];break}}return t?(e._src=t,new l(e),e._webAudio&&c(e),e):void e._emit("loaderror")}e._emit("loaderror")},play:function(e){var t=this,n=arguments,o=null;if("number"==typeof e)o=e,e=null;else if(void 0===e){e="__default";for(var i=0,r=0;r<t._sounds.length;r++)t._sounds[r]._paused&&!t._sounds[r]._ended&&(i++,o=t._sounds[r]._id);1===i?e=null:o=null}var a=o?t._soundById(o):t._inactiveSound();if(!a)return null;if(o&&!e&&(e=a._sprite||"__default"),!t._loaded&&!t._sprite[e])return t.once("load",function(){t.play(t._soundById(a._id)?a._id:void 0)}),a._id;if(o&&!a._paused)return a._id;var s=0<a._seek?a._seek:t._sprite[e][0]/1e3,l=(t._sprite[e][0]+t._sprite[e][1])/1e3-s,d=1e3*l/Math.abs(a._rate);t._endTimers[a._id]=setTimeout(t._ended.bind(t,a),d),a._paused=!1,a._ended=!1,a._sprite=e,a._seek=s,a._start=t._sprite[e][0]/1e3,a._stop=(t._sprite[e][0]+t._sprite[e][1])/1e3,a._loop=!(!a._loop&&!t._sprite[e][2]);var c=a._node;if(t._webAudio){var u=function(){t._refreshBuffer(a);var e=a._muted||t._muted?0:a._volume*_.volume();c.gain.setValueAtTime(e,p.currentTime),a._playStart=p.currentTime,void 0===c.bufferSource.start?a._loop?c.bufferSource.noteGrainOn(0,s,86400):c.bufferSource.noteGrainOn(0,s,l):a._loop?c.bufferSource.start(0,s,86400):c.bufferSource.start(0,s,l),t._endTimers[a._id]||(t._endTimers[a._id]=setTimeout(t._ended.bind(t,a),d)),n[1]||setTimeout(function(){t._emit("play",a._id)},0)};t._loaded?u():(t.once("load",u),t._clearTimer(a._id))}else{var h=function(){c.currentTime=s,c.muted=a._muted||t._muted||_._muted||c.muted,c.volume=a._volume*_.volume(),c.playbackRate=a._rate,setTimeout(function(){c.play(),n[1]||t._emit("play",a._id)},0)};if(4===c.readyState||!c.readyState&&navigator.isCocoonJS)h();else{var f=function(){t._endTimers[a._id]=setTimeout(t._ended.bind(t,a),d),h(),c.removeEventListener("canplaythrough",f,!1)};c.addEventListener("canplaythrough",f,!1),t._clearTimer(a._id)}}return a._id},pause:function(e){var t=this;if(!t._loaded)return t.once("play",function(){t.pause(e)}),t;for(var n=t._getSoundIds(e),o=0;o<n.length;o++){t._clearTimer(n[o]);var i=t._soundById(n[o]);if(i&&!i._paused){if(i._seek=t.seek(n[o]),i._paused=!0,t._webAudio){if(!i._node.bufferSource)return t;void 0===i._node.bufferSource.stop?i._node.bufferSource.noteOff(0):i._node.bufferSource.stop(0),i._node.bufferSource=null}else isNaN(i._node.duration)||i._node.pause();arguments[1]||t._emit("pause",i._id)}}return t},stop:function(e){var t=this;if(!t._loaded)return void 0!==t._sounds[0]._sprite&&t.once("play",function(){t.stop(e)}),t;for(var n=t._getSoundIds(e),o=0;o<n.length;o++){t._clearTimer(n[o]);var i=t._soundById(n[o]);if(i&&!i._paused){if(i._seek=i._start||0,i._paused=!0,i._ended=!0,t._webAudio&&i._node){if(!i._node.bufferSource)return t;void 0===i._node.bufferSource.stop?i._node.bufferSource.noteOff(0):i._node.bufferSource.stop(0),i._node.bufferSource=null}else i._node&&!isNaN(i._node.duration)&&(i._node.pause(),i._node.currentTime=i._start||0);t._emit("stop",i._id)}}return t},mute:function(e,t){var n=this;if(!n._loaded)return n.once("play",function(){n.mute(e,t)}),n;if(void 0===t){if("boolean"!=typeof e)return n._muted;n._muted=e}for(var o=n._getSoundIds(t),i=0;i<o.length;i++){var r=n._soundById(o[i]);r&&(r._muted=e,n._webAudio&&r._node?r._node.gain.setValueAtTime(e?0:r._volume*_.volume(),p.currentTime):r._node&&(r._node.muted=!!_._muted||e))}return n},volume:function(){var e,t,n,o=this,i=arguments;if(0===i.length)return o._volume;1===i.length?0<=o._getSoundIds().indexOf(i[0])?t=parseInt(i[0],10):e=parseFloat(i[0]):2===i.length&&(e=parseFloat(i[0]),t=parseInt(i[1],10));if(!(void 0!==e&&0<=e&&e<=1))return(n=t?o._soundById(t):o._sounds[0])?n._volume:0;if(!o._loaded)return o.once("play",function(){o.volume.apply(o,i)}),o;void 0===t&&(o._volume=e),t=o._getSoundIds(t);for(var r=0;r<t.length;r++)(n=o._soundById(t[r]))&&(n._volume=e,o._webAudio&&n._node&&!n._muted?n._node.gain.setValueAtTime(e*_.volume(),p.currentTime):n._node&&!n._muted&&(n._node.volume=e*_.volume()));return o},fade:function(e,o,t,n){var i=this;if(!i._loaded)return i.once("play",function(){i.fade(e,o,t,n)}),i;i.volume(e,n);for(var r=i._getSoundIds(n),a=0;a<r.length;a++){var s=i._soundById(r[a]);if(s)if(i._webAudio&&!s._muted){var l=p.currentTime,d=l+t/1e3;s._volume=e,s._node.gain.setValueAtTime(e,l),s._node.gain.linearRampToValueAtTime(o,d),setTimeout(function(e,t){setTimeout(function(){t._volume=o,i._emit("faded",e)},0<d-p.currentTime?Math.ceil(1e3*(d-p.currentTime)):0)}.bind(i,r[a],s),t)}else{var c=Math.abs(e-o),u=o<e?"out":"in",h=t/(c/.01);!function(){var t=e,n=setInterval(function(e){t+="in"===u?.01:-.01,t=Math.max(0,t),t=Math.min(1,t),t=Math.round(100*t)/100,i.volume(t,e),t===o&&(clearInterval(n),i._emit("faded",e))}.bind(i,r[a]),h)}()}}return i},loop:function(){var e,t,n,o=this,i=arguments;if(0===i.length)return o._loop;if(1===i.length){if("boolean"!=typeof i[0])return!!(n=o._soundById(parseInt(i[0],10)))&&n._loop;e=i[0],o._loop=e}else 2===i.length&&(e=i[0],t=parseInt(i[1],10));for(var r=o._getSoundIds(t),a=0;a<r.length;a++)(n=o._soundById(r[a]))&&(n._loop=e,o._webAudio&&n._node&&n._node.bufferSource&&(n._node.bufferSource.loop=e));return o},rate:function(){var e,t,n,o=this,i=arguments;if(0===i.length)t=o._sounds[0]._id;else if(1===i.length){0<=o._getSoundIds().indexOf(i[0])?t=parseInt(i[0],10):e=parseFloat(i[0])}else 2===i.length&&(e=parseFloat(i[0]),t=parseInt(i[1],10));if("number"!=typeof e)return(n=o._soundById(t))?n._rate:o._rate;if(!o._loaded)return o.once("load",function(){o.rate.apply(o,i)}),o;void 0===t&&(o._rate=e),t=o._getSoundIds(t);for(var r=0;r<t.length;r++)if(n=o._soundById(t[r])){n._rate=e,o._webAudio&&n._node&&n._node.bufferSource?n._node.bufferSource.playbackRate.value=e:n._node&&(n._node.playbackRate=e);var a=o.seek(t[r]),s=1e3*((o._sprite[n._sprite][0]+o._sprite[n._sprite][1])/1e3-a)/Math.abs(n._rate);o._clearTimer(t[r]),o._endTimers[t[r]]=setTimeout(o._ended.bind(o,n),s)}return o},seek:function(){var e,t,n=this,o=arguments;if(0===o.length)t=n._sounds[0]._id;else if(1===o.length){0<=n._getSoundIds().indexOf(o[0])?t=parseInt(o[0],10):(t=n._sounds[0]._id,e=parseFloat(o[0]))}else 2===o.length&&(e=parseFloat(o[0]),t=parseInt(o[1],10));if(void 0===t)return n;if(!n._loaded)return n.once("load",function(){n.seek.apply(n,o)}),n;var i=n._soundById(t);if(i){if(!(0<=e))return n._webAudio?i._seek+(n.playing(t)?p.currentTime-i._playStart:0):i._node.currentTime;var r=n.playing(t);r&&n.pause(t,!0),i._seek=e,n._clearTimer(t),r&&n.play(t,!0)}return n},playing:function(e){var t=this._soundById(e)||this._sounds[0];return!!t&&!t._paused},duration:function(){return this._duration},unload:function(){for(var e=this,t=e._sounds,n=0;n<t.length;n++){t[n]._paused||(e.stop(t[n]._id),e._emit("end",t[n]._id)),e._webAudio||(t[n]._node.src="",t[n]._node.removeEventListener("error",t[n]._errorFn,!1),t[n]._node.removeEventListener("canplaythrough",t[n]._loadFn,!1)),delete t[n]._node,e._clearTimer(t[n]._id);var o=_._howls.indexOf(e);0<=o&&_._howls.splice(o,1)}return d&&delete d[e._src],e=null},on:function(e,t,n,o){var i=this["_on"+e];return"function"==typeof t&&i.push(o?{id:n,fn:t,once:o}:{id:n,fn:t}),this},off:function(e,t,n){var o=this["_on"+e];if(t){for(var i=0;i<o.length;i++)if(t===o[i].fn&&n===o[i].id){o.splice(i,1);break}}else this["on"+e]=[];return this},once:function(e,t,n){return this.on(e,t,n,1),this},_emit:function(e,t,n){for(var o=this["_on"+e],i=0;i<o.length;i++)o[i].id&&o[i].id!==t||(setTimeout(function(e){e.call(this,t,n)}.bind(this,o[i].fn),0),o[i].once&&this.off(e,o[i].fn,t));return this},_ended:function(e){var t=this,n=e._sprite,o=!(!e._loop&&!t._sprite[n][2]);if(t._emit("end",e._id),!t._webAudio&&o&&t.stop(e._id).play(e._id),t._webAudio&&o){t._emit("play",e._id),e._seek=e._start||0,e._playStart=p.currentTime;var i=1e3*(e._stop-e._start)/Math.abs(e._rate);t._endTimers[e._id]=setTimeout(t._ended.bind(t,e),i)}return t._webAudio&&!o&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,t._clearTimer(e._id),e._node.bufferSource=null),t._webAudio||o||t.stop(e._id),t},_clearTimer:function(e){return this._endTimers[e]&&(clearTimeout(this._endTimers[e]),delete this._endTimers[e]),this},_soundById:function(e){for(var t=0;t<this._sounds.length;t++)if(e===this._sounds[t]._id)return this._sounds[t];return null},_inactiveSound:function(){var e=this;e._drain();for(var t=0;t<e._sounds.length;t++)if(e._sounds[t]._ended)return e._sounds[t].reset();return new l(e)},_drain:function(){var e=this,t=e._pool,n=0,o=0;if(!(e._sounds.length<t)){for(o=0;o<e._sounds.length;o++)e._sounds[o]._ended&&n++;for(o=e._sounds.length-1;0<=o;o--){if(n<=t)return;e._sounds[o]._ended&&(e._webAudio&&e._sounds[o]._node&&e._sounds[o]._node.disconnect(0),e._sounds.splice(o,1),n--)}}},_getSoundIds:function(e){if(void 0!==e)return[e];for(var t=[],n=0;n<this._sounds.length;n++)t.push(this._sounds[n]._id);return t},_refreshBuffer:function(e){return e._node.bufferSource=p.createBufferSource(),e._node.bufferSource.buffer=d[this._src],e._node.bufferSource.connect(e._panner?e._panner:e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop),e._node.bufferSource.playbackRate.value=this._rate,this}};var l=function(e){this._parent=e,this.init()};if(l.prototype={init:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._muted=t._muted,e._rate=t._rate,e._seek=0,e._paused=!0,e._ended=!0,e._id=Math.round(Date.now()*Math.random()),t._sounds.push(e),e.create(),e},create:function(){var e=this,t=e._parent,n=_._muted||e._muted||e._parent._muted?0:e._volume*_.volume();return t._webAudio?(e._node=void 0===p.createGain?p.createGainNode():p.createGain(),e._node.gain.setValueAtTime(n,p.currentTime),e._node.paused=!0,e._node.connect(s)):(e._node=new Audio,e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener("canplaythrough",e._loadFn,!1),e._node.src=t._src,e._node.preload="auto",e._node.volume=n,e._node.load()),e},reset:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._muted=t._muted,e._rate=t._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite=null,e._id=Math.round(Date.now()*Math.random()),e},_errorListener:function(){var e=this;e._node.error&&4===e._node.error.code&&(_.noAudio=!0),e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorListener,!1)},_loadListener:function(){var e=this._parent;e._duration=Math.ceil(10*this._node.duration)/10,0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),e._loaded||(e._loaded=!0,e._emit("load")),e._autoplay&&e.play(),this._node.removeEventListener("canplaythrough",this._loadFn,!1)}},a)var d={},c=function(e){var t=e._src;if(d[t])return e._duration=d[t].duration,void f(e);if(/^data:[^;]+;base64,/.test(t)){window.atob=window.atob||function(e){for(var t,n,o=String(e).replace(/=+$/,""),i=0,r=0,a="";n=o.charAt(r++);~n&&(t=i%4?64*t+n:n,i++%4)?a+=String.fromCharCode(255&t>>(-2*i&6)):0)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return a};for(var n=atob(t.split(",")[1]),o=new Uint8Array(n.length),i=0;i<n.length;++i)o[i]=n.charCodeAt(i);h(o.buffer,e)}else{var r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType="arraybuffer",r.onload=function(){h(r.response,e)},r.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete d[t],e.load())},u(r)}},u=function(t){try{t.send()}catch(e){t.onerror()}},h=function(e,t){p.decodeAudioData(e,function(e){e&&(d[t._src]=e,f(t,e))},function(){t._emit("loaderror")})},f=function(e,t){t&&!e._duration&&(e._duration=t.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),e._loaded||(e._loaded=!0,e._emit("load")),e._autoplay&&e.play()};void 0!==n&&(n.Howler=_,n.Howl=t),"undefined"!=typeof window&&(window.HowlerGlobal=e,window.Howler=_,window.Howl=t,window.Sound=l)}(),function(){"use strict";var n,i,t,e;HowlerGlobal.prototype.init=(e=HowlerGlobal.prototype.init,function(){return this._pos=[0,0,0],this._orientation=[0,0,-1,0,1,0],this._velocity=[0,0,0],this._listenerAttr={dopplerFactor:1,speedOfSound:343.3},e.call(this,o)}),HowlerGlobal.prototype.pos=function(e,t,n){var o=this;return o.ctx&&o.ctx.listener?(t="number"!=typeof t?o._pos[1]:t,n="number"!=typeof n?o._pos[2]:n,"number"!=typeof e?o._pos:(o._pos=[e,t,n],o.ctx.listener.setPosition(o._pos[0],o._pos[1],o._pos[2]),o)):o},HowlerGlobal.prototype.orientation=function(e,t,n,o,i,r){var a=this;if(!a.ctx||!a.ctx.listener)return a;var s=a._orientation;return t="number"!=typeof t?s[1]:t,n="number"!=typeof n?s[2]:n,o="number"!=typeof o?s[3]:o,i="number"!=typeof i?s[4]:i,r="number"!=typeof r?s[5]:r,"number"!=typeof e?s:(a._orientation=[e,t,n,o,i,r],a.ctx.listener.setOrientation(s[0],s[1],s[2],s[3],s[4],s[5]),a)},HowlerGlobal.prototype.velocity=function(e,t,n){var o=this;return o.ctx&&o.ctx.listener?(t="number"!=typeof t?o._velocity[1]:t,n="number"!=typeof n?o._velocity[2]:n,"number"!=typeof e?o._velocity:(o._velocity=[e,t,n],o.ctx.listener.setVelocity(o._velocity[0],o._velocity[1],o._velocity[2]),o)):o},HowlerGlobal.prototype.listenerAttr=function(e){var t=this;if(!t.ctx||!t.ctx.listener)return t;var n=t._listenerAttr;return e?(t._listenerAttr={dopplerFactor:void 0!==e.dopplerFactor?e.dopplerFactor:n.dopplerFactor,speedOfSound:void 0!==e.speedOfSound?e.speedOfSound:n.speedOfSound},t.ctx.listener.dopplerFactor=n.dopplerFactor,t.ctx.listener.speedOfSound=n.speedOfSound,t):n},Howl.prototype.init=(t=Howl.prototype.init,function(e){return this._orientation=e.orientation||[1,0,0],this._pos=e.pos||null,this._velocity=e.velocity||[0,0,0],this._pannerAttr={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:360,coneOUterAngle:void 0!==e.coneOUterAngle?e.coneOUterAngle:360,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:0,distanceModel:void 0!==e.distanceModel?e.distanceModel:"inverse",maxDistance:void 0!==e.maxDistance?e.maxDistance:1e4,panningModel:void 0!==e.panningModel?e.panningModel:"HRTF",refDistance:void 0!==e.refDistance?e.refDistance:1,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:1},t.call(this,e)}),Howl.prototype.pos=function(e,t,n,o){var i=this;if(!i._webAudio)return i;if(!i._loaded)return i.once("play",function(){i.pos(e,t,n,o)}),i;if(t="number"!=typeof t?0:t,n="number"!=typeof n?-.5:n,void 0===o){if("number"!=typeof e)return i._pos;i._pos=[e,t,n]}for(var r=i._getSoundIds(o),a=0;a<r.length;a++){var s=i._soundById(r[a]);if(s){if("number"!=typeof e)return s._pos;s._pos=[e,t,n],s._node&&(s._panner||d(s),s._panner.setPosition(e,t,n))}}return i},Howl.prototype.orientation=function(e,t,n,o){var i=this;if(!i._webAudio)return i;if(!i._loaded)return i.once("play",function(){i.orientation(e,t,n,o)}),i;if(t="number"!=typeof t?i._orientation[1]:t,n="number"!=typeof n?i._orientation[1]:n,void 0===o){if("number"!=typeof e)return i._orientation;i._orientation=[e,t,n]}for(var r=i._getSoundIds(o),a=0;a<r.length;a++){var s=i._soundById(r[a]);if(s){if("number"!=typeof e)return s._orientation;s._orientation=[e,t,n],s._node&&(s._panner||d(s),s._panner.setOrientation(e,t,n))}}return i},Howl.prototype.velocity=function(e,t,n,o){var i=this;if(!i._webAudio)return i;if(!i._loaded)return i.once("play",function(){i.velocity(e,t,n,o)}),i;if(t="number"!=typeof t?i._velocity[1]:t,n="number"!=typeof n?i._velocity[1]:n,void 0===o){if("number"!=typeof e)return i._velocity;i._velocity=[e,t,n]}for(var r=i._getSoundIds(o),a=0;a<r.length;a++){var s=i._soundById(r[a]);if(s){if("number"!=typeof e)return s._velocity;s._velocity=[e,t,n],s._node&&(s._panner||d(s),s._panner.setVelocity(e,t,n))}}return i},Howl.prototype.pannerAttr=function(){var e,t,n,o=this,i=arguments;if(!o._webAudio)return o;if(0===i.length)return o._pannerAttr;if(1===i.length){if("object"!=typeof i[0])return(n=o._soundById(parseInt(i[0],10)))?n._pannerAttr:o._pannerAttr;e=i[0],void 0===t&&(o._pannerAttr={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:o._coneInnerAngle,coneOUterAngle:void 0!==e.coneOUterAngle?e.coneOUterAngle:o._coneOUterAngle,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:o._coneOuterGain,distanceModel:void 0!==e.distanceModel?e.distanceModel:o._distanceModel,maxDistance:void 0!==e.maxDistance?e.maxDistance:o._maxDistance,panningModel:void 0!==e.panningModel?e.panningModel:o._panningModel,refDistance:void 0!==e.refDistance?e.refDistance:o._refDistance,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:o._rolloffFactor})}else 2===i.length&&(e=i[0],t=parseInt(i[1],10));for(var r=o._getSoundIds(t),a=0;a<r.length;a++)if(n=o._soundById(r[a])){var s=n._pannerAttr;s={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:s.coneInnerAngle,coneOUterAngle:void 0!==e.coneOUterAngle?e.coneOUterAngle:s.coneOUterAngle,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:s.coneOuterGain,distanceModel:void 0!==e.distanceModel?e.distanceModel:s.distanceModel,maxDistance:void 0!==e.maxDistance?e.maxDistance:s.maxDistance,panningModel:void 0!==e.panningModel?e.panningModel:s.panningModel,refDistance:void 0!==e.refDistance?e.refDistance:s.refDistance,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:s.rolloffFactor};var l=n._panner;l?(l.coneInnerAngle=s.coneInnerAngle,l.coneOUterAngle=s.coneOUterAngle,l.coneOuterGain=s.coneOuterGain,l.distanceModel=s.distanceModel,l.maxDistance=s.maxDistance,l.panningModel=s.panningModel,l.refDistance=s.refDistance,l.rolloffFactor=s.rolloffFactor):(n._pos||(n._pos=o._pos||[0,0,-.5]),d(n))}return o},Sound.prototype.init=(i=Sound.prototype.init,function(){var e=this,t=e._parent;e._orientation=t._orientation,e._pos=t._pos,e._velocity=t._velocity,e._pannerAttr=t._pannerAttr,i.call(this),e._pos&&t.pos(e._pos[0],e._pos[1],e._pos[2],e._id)}),Sound.prototype.reset=(n=Sound.prototype.reset,function(){var e=this,t=e._parent;return e._orientation=t._orientation,e._pos=t._pos,e._velocity=t._velocity,e._pannerAttr=t._pannerAttr,n.call(this)});var d=function(e){e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOUterAngle=e._pannerAttr.coneOUterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.panningModel=e._pannerAttr.panningModel,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2]),e._panner.setVelocity(e._velocity[0],e._velocity[1],e._velocity[2]),e._panner.connect(e._node),e._paused||e._parent.pause(e._id).play(e._id)}}()},{}],23:[function(e,t,n){"object"==typeof t&&(t.exports=function(){function r(e,t,n){return(e=document.createElement(e)).id=t,e.style.cssText=n,e}function e(e,t,n){var o=r("div",e,"padding:0 0 3px 3px;text-align:left;background:"+n),i=r("div",e+"Text","font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px;color:"+t);for(i.innerHTML=e.toUpperCase(),o.appendChild(i),e=r("div",e+"Graph","width:74px;height:30px;background:"+t),o.appendChild(e),t=0;t<74;t++)e.appendChild(r("span","","width:1px;height:30px;float:left;opacity:0.9;background:"+n));return o}function t(e){for(var t=c.children,n=0;n<t.length;n++)t[n].style.display=n===e?"block":"none";d=e}function o(e,t){e.appendChild(e.firstChild).style.height=Math.min(30,30-30*t)+"px"}var i=self.performance&&self.performance.now?self.performance.now.bind(performance):Date.now,a=i(),s=a,l=0,d=0,c=r("div","stats","width:80px;opacity:0.9;cursor:pointer");c.addEventListener("mousedown",function(e){e.preventDefault(),t(++d%c.children.length)},!1);var u=0,h=1/0,f=0,p=(n=e("fps","#0ff","#002")).children[0],_=n.children[1];c.appendChild(n);var m=0,g=1/0,y=0,v=(n=e("ms","#0f0","#020")).children[0],b=n.children[1];if(c.appendChild(n),self.performance&&self.performance.memory){var n,x=0,w=1/0,S=0,C=(n=e("mb","#f08","#201")).children[0],E=n.children[1];c.appendChild(n)}return t(d),{REVISION:14,domElement:c,setMode:t,begin:function(){a=i()},end:function(){var e=i();if(m=e-a,g=Math.min(g,m),y=Math.max(y,m),v.textContent=(0|m)+" MS ("+(0|g)+"-"+(0|y)+")",o(b,m/200),l++,s+1e3<e&&(u=Math.round(1e3*l/(e-s)),h=Math.min(h,u),f=Math.max(f,u),p.textContent=u+" FPS ("+h+"-"+f+")",o(_,u/100),s=e,void(l=0)!==x)){var t=performance.memory.usedJSHeapSize,n=performance.memory.jsHeapSizeLimit;x=Math.round(954e-9*t),w=Math.min(w,x),S=Math.max(S,x),C.textContent=x+" MB ("+w+"-"+S+")",o(E,t/n)}return e},update:function(){a=this.end()}}})},{}]},{},[14])(14)});
//# sourceMappingURL=gameTurf-min.js.map
